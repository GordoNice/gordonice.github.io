
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User’s Guide &#8212; FitsGeo 1.0.0 documentation</title>
    <link rel="stylesheet" href="{{ base_path }}/fitsgeo/_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="{{ base_path }}/fitsgeo/_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="{{ base_path }}/fitsgeo/_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="{{ base_path }}/fitsgeo/_static/contentui.css" />
    <script id="documentation_options" data-url_root="./" src="{{ base_path }}/fitsgeo/_static/documentation_options.js"></script>
    <script src="{{ base_path }}/fitsgeo/_static/jquery.js"></script>
    <script src="{{ base_path }}/fitsgeo/_static/underscore.js"></script>
    <script src="{{ base_path }}/fitsgeo/_static/doctools.js"></script>
    <script src="{{ base_path }}/fitsgeo/_static/language_data.js"></script>
    <script src="{{ base_path }}/fitsgeo/_static/contentui.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]]}})</script>
    <link rel="shortcut icon" href="{{ base_path }}/fitsgeo/_static/favicon.svg"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Predefined Materials" href="material.html" />
    <link rel="prev" title="Installation Guide" href="install.html" />
   
  <link rel="stylesheet" href="{{ base_path }}/fitsgeo/_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="{{ base_path }}/fitsgeo/_static/logo.svg" alt="Logo"/>
    
  </a>
</p>



<p class="blurb">Python package for PHITS geometry development and visualization</p>






<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation Guide</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">User’s Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#implemented-features">Implemented features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Material module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Const module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">Surface module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">Cell module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id6">Export module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#example-0-the-column">Example 0: The Column</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-1-general-illustrative-example-of-fitsgeo">Example 1: general illustrative example of FitsGeo</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-2-a-spheres-with-hats">Example 2(a): Spheres with Hats</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-2-b-snake">Example 2(b): Snake!</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-3-snowman">Example 3: Snowman</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="material.html">Predefined Materials</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="authors.html">Credits</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="user-s-guide">
<h1>User’s Guide<a class="headerlink" href="#user-s-guide" title="Permalink to this headline">¶</a></h1>
<p class="rubric">Guide covers almost all features and FitsGeo capabilities with examples</p>
<p>The guide is intended for users who are familiar with the PHITS code. Therefore, many nuances of working with PHITS go beyond of the scope of this FitsGeo documentation. To clarify missing parts please visit <a class="reference external" href="https://phits.jaea.go.jp/rireki-manuale.html">PHIST manual</a> first.</p>
<div class="section" id="implemented-features">
<h2>Implemented features<a class="headerlink" href="#implemented-features" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Section describes all current implemented modules with their capabilities and functionality</p>
<p>Currently, FitsGeo package consists of: <code class="docutils literal notranslate"><span class="pre">material</span></code>, <code class="docutils literal notranslate"><span class="pre">const</span></code>, <code class="docutils literal notranslate"><span class="pre">surface</span></code>, <code class="docutils literal notranslate"><span class="pre">cell</span></code> and <code class="docutils literal notranslate"><span class="pre">export</span></code> modules. Thus, each of them responsable for certain tasks:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">material</span></code> handles material definitions, materials can be set from predefined databases or manually (see <a class="reference external" href="user_guide.html#id1">Material module</a> section)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">const</span></code> consists of constants used in FitsGeo: colors for surfaces as VPython vectors and ANGEL (builtin visualization in PHITS) colors associated to these colors (in Python dictionary), <span class="math notranslate nohighlight">\(\pi\)</span> definition from NumPy as math constant (see <a class="reference external" href="user_guide.html#id2">Const module</a> section)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">surface</span></code> consists of classes for defining surfaces (see <a class="reference external" href="user_guide.html#id4">Surface module</a> section)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cell</span></code> consists of class to define cells: more concrete volumes as combinations of surfaces with materials (see <a class="reference external" href="user_guide.html#id5">Cell module</a> section)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">export</span></code> provides functionality for export of all defined objects to PHITS understandable format (other MC codes may be added in the future releases, see <a class="reference external" href="user_guide.html#id6">Export module</a> section)</p></li>
</ul>
<p>More modules for other sections of PHITS input will come soon.</p>
<div class="section" id="id1">
<h3>Material module<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>At first, user need to define materials for his future geometry. Material module have a <code class="docutils literal notranslate"><span class="pre">Material</span></code> class, which defines materials for PHTIS [ Material ] section. Parameters, which can be provided for <code class="docutils literal notranslate"><span class="pre">Material</span></code> class:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">elements:</span> <span class="pre">list</span></code> — elements in [[A1, Z1, Q1], [A2, Z2, Q2], …] format, where A — mass number, Z — atomic number, Q — quantity of ratio (<code class="docutils literal notranslate"><span class="pre">&quot;atomic&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;mass&quot;</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name:</span> <span class="pre">str</span></code> — name for material object</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ratio_type:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">&quot;atomic&quot;</span></code> — type of ratio: <code class="docutils literal notranslate"><span class="pre">&quot;atomic&quot;</span></code> (by default) or <code class="docutils literal notranslate"><span class="pre">&quot;mass&quot;</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">density:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">1.0</span></code> — density for material [g/cm<span class="math notranslate nohighlight">\(^3\)</span>] (<code class="docutils literal notranslate"><span class="pre">1.0</span></code> by default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gas:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></code> — <code class="docutils literal notranslate"><span class="pre">True</span></code> if gas (<code class="docutils literal notranslate"><span class="pre">False</span></code> by default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">color:</span> <span class="pre">str</span></code> — one of colors for material visualization via ANGEL</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">matn:</span> <span class="pre">int</span></code> — material object number, automatically set after every new material initialization, but can be changed manually after initialization</p></li>
</ul>
<p>In addition to this, <code class="docutils literal notranslate"><span class="pre">Material</span></code> class has <code class="docutils literal notranslate"><span class="pre">database</span></code> class method. This method can be used to define material from databases. Parameters of this method:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name:</span> <span class="pre">str</span></code> — name of material from databases</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">gas:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></code> — <code class="docutils literal notranslate"><span class="pre">True</span></code> if gas (<code class="docutils literal notranslate"><span class="pre">False</span></code> by default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">color:</span> <span class="pre">str</span></code> — one of colors for material visualization via ANGEL</p></li>
</ul>
<p>Thus, any material can be defined in two ways:</p>
<ol class="arabic simple">
<li><p>Using predefined databases</p></li>
<li><p>Manually</p></li>
</ol>
<p>In the first case, the user only needs to specify the name of the desired material and color or gas flag (optionally):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">water</span> <span class="o">=</span> <span class="n">fitsgeo</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_WATER&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>All available materials with their names and other properties are listed in the <a class="reference external" href="material.html">Predefined Materials</a> section.</p>
<p>Following second way, user need to provide <code class="docutils literal notranslate"><span class="pre">elements</span></code> list and other parameters if needed:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">water</span> <span class="o">=</span> <span class="n">fitsgeo</span><span class="o">.</span><span class="n">Material</span><span class="p">(</span>
        <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Water&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>In this particular example we don’t need to additionally set <code class="docutils literal notranslate"><span class="pre">ratio_type</span></code> and <code class="docutils literal notranslate"><span class="pre">gas</span></code> parameters, because these parameters’ default values fit to our needs. But, for example, if we want this to be water vapor:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">water_vapor</span> <span class="o">=</span> <span class="n">fitsgeo</span><span class="o">.</span><span class="n">Material</span><span class="p">(</span>
        <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Water Vapor&quot;</span><span class="p">,</span> <span class="n">gas</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;pastelblue&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Additional <code class="docutils literal notranslate"><span class="pre">gas</span></code> flag must be provided.</p>
<p>All colors for materials defined through <code class="docutils literal notranslate"><span class="pre">color</span></code> parameter and must be taken as <code class="docutils literal notranslate"><span class="pre">ANGEL_COLORS</span></code> dictionary keys (see next section).</p>
<p>If user does not provide any materials for surfaces or cells, <code class="docutils literal notranslate"><span class="pre">MAT_WATER</span></code> material is used by default for surfaces and cells. This material, as well as the materials for void and “outer void” are predefined as constants in the <code class="docutils literal notranslate"><span class="pre">material</span></code> module:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Predefined materials as constants</span>
<span class="n">MAT_OUTER</span> <span class="o">=</span> <span class="n">Material</span><span class="p">([],</span> <span class="n">matn</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>  <span class="c1"># Special material for outer void</span>
<span class="n">MAT_VOID</span> <span class="o">=</span> <span class="n">Material</span><span class="p">([],</span> <span class="n">matn</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>  <span class="c1"># Special material for void</span>
<span class="n">MAT_WATER</span> <span class="o">=</span> <span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_WATER&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>  <span class="c1"># Default water</span>
</pre></div>
</div>
<p>These materials can be invoked directly from <code class="docutils literal notranslate"><span class="pre">fitsgeo</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fitsgeo</span><span class="o">.</span><span class="n">MAT_OUTER</span>
<span class="n">fitsgeo</span><span class="o">.</span><span class="n">MAT_VOID</span>
<span class="n">fitsgeo</span><span class="o">.</span><span class="n">MAT_WATER</span>
</pre></div>
</div>
<p>All defined materials should be passed as parameters during initialization of surfaces and cells objects. Otherwise, default <code class="docutils literal notranslate"><span class="pre">MAT_WATER</span></code> material will be used.</p>
<p><strong>Question:</strong> <em>Why do we need to pass materials both to the surface objects and to the cells?</em></p>
<blockquote>
<div><p><strong>Answer:</strong> in surface objects materials are used for visualization purposes: depending on material properties (<code class="docutils literal notranslate"><span class="pre">gas</span></code>, <code class="docutils literal notranslate"><span class="pre">color</span></code>) color and opacity for surface draw selected. Cell objects use another properties of material (<code class="docutils literal notranslate"><span class="pre">matn</span></code>, <code class="docutils literal notranslate"><span class="pre">density</span></code>)</p>
</div></blockquote>
<p>Material module have a global <code class="docutils literal notranslate"><span class="pre">created_materials</span></code> list, this list contains all defined materials. This way, all materials could be easily accessed and modified, if needed.</p>
</div>
<div class="section" id="id2">
<h3>Const module<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Const module mainly provides color constants: VPython vectors for VPython surface visualization. <code class="docutils literal notranslate"><span class="pre">ANGEL_COLORS</span></code> is a Python dictionary in <code class="docutils literal notranslate"><span class="pre">const</span></code> module, this dictionary provides color matching of ANGEL colors (keys in dictionary) to those colors defined through VPython vectors (values in dictionary). In that way, we will have similar colors both in FitsGeo and in PHITS visualization based on ANGEL. Table below shows all available for visualization colors.</p>
<div class="toggle-header docutils container">
<p><strong>Table: dictionary with ANGEL and VPython vector colors match</strong></p>
</div>
<div class="toggle-content docutils container">
<blockquote>
<div><table class="longtable docutils align-default" id="id8">
<caption><span class="caption-text"><strong>Dictionary with ANGEL and VPython vector colors match</strong></span><a class="headerlink" href="#id8" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 30%" />
<col style="width: 36%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>ANGEL
color</p></th>
<th class="head"><p>constant in
<code class="docutils literal notranslate"><span class="pre">const</span></code> module</p></th>
<th class="head"><p>RGB
color</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>white</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">WHITE</span></code></p></td>
<td><p>(255, 255, 255)</p></td>
</tr>
<tr class="row-odd"><td><p>lightgray</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">LIGHTGRAY</span></code></p></td>
<td><p>(211, 211, 211)</p></td>
</tr>
<tr class="row-even"><td><p>gray</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">GRAY</span></code></p></td>
<td><p>(169, 169, 169)</p></td>
</tr>
<tr class="row-odd"><td><p>darkgray</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DARKGRAY</span></code></p></td>
<td><p>(128, 128, 128)</p></td>
</tr>
<tr class="row-even"><td><p>matblack</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DIMGRAY</span></code></p></td>
<td><p>(105, 105, 105)</p></td>
</tr>
<tr class="row-odd"><td><p>black</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BLACK</span></code></p></td>
<td><p>(0, 0, 0)</p></td>
</tr>
<tr class="row-even"><td><p>darkred</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DARKRED</span></code></p></td>
<td><p>(139, 0, 0)</p></td>
</tr>
<tr class="row-odd"><td><p>red</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">RED</span></code></p></td>
<td><p>(255, 0, 0)</p></td>
</tr>
<tr class="row-even"><td><p>pink</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">PINK</span></code></p></td>
<td><p>(219, 112, 147)</p></td>
</tr>
<tr class="row-odd"><td><p>pastelpink</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">NAVAJOWHITE</span></code></p></td>
<td><p>(255, 222, 173)</p></td>
</tr>
<tr class="row-even"><td><p>orange</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DARKORANGE</span></code></p></td>
<td><p>(255, 140, 0)</p></td>
</tr>
<tr class="row-odd"><td><p>brown</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SADDLEBROWN</span></code></p></td>
<td><p>(139, 69, 19)</p></td>
</tr>
<tr class="row-even"><td><p>darkbrown</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DARKBROWN</span></code></p></td>
<td><p>(51, 25, 0)</p></td>
</tr>
<tr class="row-odd"><td><p>pastelbrown</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">PASTELBROWN</span></code></p></td>
<td><p>(131, 105, 83)</p></td>
</tr>
<tr class="row-even"><td><p>orangeyellow</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">GOLD</span></code></p></td>
<td><p>(255, 215, 0)</p></td>
</tr>
<tr class="row-odd"><td><p>camel</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">OLIVE</span></code></p></td>
<td><p>(128, 128, 0)</p></td>
</tr>
<tr class="row-even"><td><p>pastelyellow</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">PASTELYELLOW</span></code></p></td>
<td><p>(255, 255, 153)</p></td>
</tr>
<tr class="row-odd"><td><p>yellow</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">YELLOW</span></code></p></td>
<td><p>(255, 255, 0)</p></td>
</tr>
<tr class="row-even"><td><p>pastelgreen</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">PASTELGREEN</span></code></p></td>
<td><p>(204, 255, 153)</p></td>
</tr>
<tr class="row-odd"><td><p>yellowgreen</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">YELLOWGREEN</span></code></p></td>
<td><p>(178, 255, 102)</p></td>
</tr>
<tr class="row-even"><td><p>green</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">GREEN</span></code></p></td>
<td><p>(0, 128, 0)</p></td>
</tr>
<tr class="row-odd"><td><p>darkgreen</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DARKGREEN</span></code></p></td>
<td><p>(0, 102, 0)</p></td>
</tr>
<tr class="row-even"><td><p>mossgreen</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">MOSSGREEN</span></code></p></td>
<td><p>(0, 51, 0)</p></td>
</tr>
<tr class="row-odd"><td><p>bluegreen</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BLUEGREEN</span></code></p></td>
<td><p>(0, 255, 128)</p></td>
</tr>
<tr class="row-even"><td><p>pastelcyan</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">PASTELCYAN</span></code></p></td>
<td><p>(153, 255, 255)</p></td>
</tr>
<tr class="row-odd"><td><p>pastelblue</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">PASTELBLUE</span></code></p></td>
<td><p>(153, 204, 255)</p></td>
</tr>
<tr class="row-even"><td><p>cyan</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CYAN</span></code></p></td>
<td><p>(0, 255, 255)</p></td>
</tr>
<tr class="row-odd"><td><p>cyanblue</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">CYANBLUE</span></code></p></td>
<td><p>(0, 102, 102)</p></td>
</tr>
<tr class="row-even"><td><p>blue</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BLUE</span></code></p></td>
<td><p>(0, 0, 255)</p></td>
</tr>
<tr class="row-odd"><td><p>violet</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">DARKVIOLET</span></code></p></td>
<td><p>(238, 130, 238)</p></td>
</tr>
<tr class="row-even"><td><p>purple</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">PURPLE</span></code></p></td>
<td><p>(128, 0, 128)</p></td>
</tr>
<tr class="row-odd"><td><p>magenta</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">MAGENTA</span></code></p></td>
<td><p>(255, 0, 255)</p></td>
</tr>
<tr class="row-even"><td><p>winered</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">MAROON</span></code></p></td>
<td><p>(128, 0, 0)</p></td>
</tr>
<tr class="row-odd"><td><p>pastelmagenta</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">VIOLET</span></code></p></td>
<td><p>(238, 130, 238)</p></td>
</tr>
<tr class="row-even"><td><p>pastelpurple</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">INDIGO</span></code></p></td>
<td><p>(75, 0, 130)</p></td>
</tr>
<tr class="row-odd"><td><p>pastelviolet</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">PASTELVIOLET</span></code></p></td>
<td><p>(204, 153, 255)</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<p>These colors in <strong>ANGEL color</strong> column are passed as the <code class="docutils literal notranslate"><span class="pre">color</span></code> parameter for material objects (see <a class="reference external" href="user_guide.html#id1">Material module</a> section).</p>
<p>Function <code class="docutils literal notranslate"><span class="pre">rgb_to_vector</span></code> in <code class="docutils literal notranslate"><span class="pre">const</span></code> module translates RGB colors to VPython vectors:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">VIOLET</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">238</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">238</span><span class="p">)</span>
</pre></div>
</div>
<p>This returns <code class="docutils literal notranslate"><span class="pre">vpython.vector</span></code> object as <code class="docutils literal notranslate"><span class="pre">VIOLET</span></code> color constant, which can be used in VPython visualization. Some more predefined colors can be found in this module.</p>
<div class="toggle-header docutils container">
<p><strong>Table: predefined VPython vector colors</strong></p>
</div>
<div class="toggle-content docutils container">
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define basic colors as constants</span>
<span class="n">RED</span> <span class="o">=</span> <span class="n">vpython</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">red</span>
<span class="n">LIME</span> <span class="o">=</span> <span class="n">vpython</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">green</span>
<span class="n">BLUE</span> <span class="o">=</span> <span class="n">vpython</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">blue</span>

<span class="n">BLACK</span> <span class="o">=</span> <span class="n">vpython</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">black</span>
<span class="n">WHITE</span> <span class="o">=</span> <span class="n">vpython</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">white</span>

<span class="n">CYAN</span> <span class="o">=</span> <span class="n">vpython</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">cyan</span>
<span class="n">YELLOW</span> <span class="o">=</span> <span class="n">vpython</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">yellow</span>
<span class="n">MAGENTA</span> <span class="o">=</span> <span class="n">vpython</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">magenta</span>
<span class="n">ORANGE</span> <span class="o">=</span> <span class="n">vpython</span><span class="o">.</span><span class="n">color</span><span class="o">.</span><span class="n">orange</span>

<span class="n">GAINSBORO</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">220</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">220</span><span class="p">)</span>
<span class="n">LIGHTGRAY</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">211</span><span class="p">,</span> <span class="mi">211</span><span class="p">,</span> <span class="mi">211</span><span class="p">)</span>
<span class="n">SILVER</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">192</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">192</span><span class="p">)</span>
<span class="n">GRAY</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">169</span><span class="p">,</span> <span class="mi">169</span><span class="p">,</span> <span class="mi">169</span><span class="p">)</span>
<span class="n">DARKGRAY</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">DIMGRAY</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">105</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">105</span><span class="p">)</span>

<span class="c1"># 6 shades of gray</span>
<span class="n">GRAY_SCALE</span> <span class="o">=</span> <span class="p">[</span><span class="n">GAINSBORO</span><span class="p">,</span> <span class="n">LIGHTGRAY</span><span class="p">,</span> <span class="n">SILVER</span><span class="p">,</span> <span class="n">GRAY</span><span class="p">,</span> <span class="n">DARKGRAY</span><span class="p">,</span> <span class="n">DIMGRAY</span><span class="p">]</span>

<span class="n">GREEN</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">OLIVE</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">BROWN</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">139</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
<span class="n">NAVY</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">TEAL</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">PURPLE</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">MAROON</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">CRIMSON</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">220</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span>
<span class="n">TOMATO</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">71</span><span class="p">)</span>
<span class="n">GOLD</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">215</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">CHOCOLATE</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">210</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="n">PERU</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">205</span><span class="p">,</span> <span class="mi">133</span><span class="p">,</span> <span class="mi">63</span><span class="p">)</span>
<span class="n">INDIGO</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">75</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">130</span><span class="p">)</span>
<span class="n">KHAKI</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">240</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">140</span><span class="p">)</span>
<span class="n">SIENNA</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">160</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">45</span><span class="p">)</span>
<span class="n">DARKRED</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">139</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">PINK</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">219</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">147</span><span class="p">)</span>
<span class="n">NAVAJOWHITE</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">222</span><span class="p">,</span> <span class="mi">173</span><span class="p">)</span>
<span class="n">DARKORANGE</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">SADDLEBROWN</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">139</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">19</span><span class="p">)</span>
<span class="n">DARKBROWN</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">51</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">DARKGOLDENROD</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">184</span><span class="p">,</span> <span class="mi">134</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
<span class="n">PASTELYELLOW</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">153</span><span class="p">)</span>
<span class="n">PASTELGREEN</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">204</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">153</span><span class="p">)</span>
<span class="n">YELLOWGREEN</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">178</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">102</span><span class="p">)</span>
<span class="n">DARKGREEN</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">MOSSGREEN</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">BLUEGREEN</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
<span class="n">PASTELCYAN</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">153</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="n">PASTELBLUE</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">153</span><span class="p">,</span> <span class="mi">204</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="n">CYANBLUE</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">102</span><span class="p">)</span>
<span class="n">DARKVIOLET</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">148</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">211</span><span class="p">)</span>
<span class="n">VIOLET</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">238</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">238</span><span class="p">)</span>
<span class="n">PASTELPURPLE</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">238</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">238</span><span class="p">)</span>
<span class="n">PASTELVIOLET</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">204</span><span class="p">,</span> <span class="mi">153</span><span class="p">,</span> <span class="mi">255</span><span class="p">)</span>
<span class="n">PASTELBROWN</span> <span class="o">=</span> <span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">131</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">83</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div>
<p>Color for surfaces is set automatically from material. Although, it can be set just before <code class="docutils literal notranslate"><span class="pre">draw()</span></code> method execution as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># BOX surface, it has MAT_WATER material as parameter be default,</span>
<span class="c1"># which color is &quot;blue&quot;</span>
<span class="n">box</span> <span class="o">=</span> <span class="n">fitsgeo</span><span class="o">.</span><span class="n">BOX</span><span class="p">()</span>

<span class="c1"># If we want to change color</span>
<span class="n">box</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">fitsgeo</span><span class="o">.</span><span class="n">YELLOWGREEN</span>

<span class="n">box</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>  <span class="c1"># This will be YELLOWGREEN, not BLUE</span>
</pre></div>
</div>
<p>Also, in this module <code class="docutils literal notranslate"><span class="pre">PI</span></code> constant defined from NumPy. Another math constants may be defined here in the future.</p>
</div>
<div class="section" id="id4">
<h3>Surface module<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>Firstly, <code class="docutils literal notranslate"><span class="pre">surface</span></code> module have <code class="docutils literal notranslate"><span class="pre">list_all_surfaces</span></code> function which prints all implemented surfaces in console:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fitsgeo</span><span class="o">.</span><span class="n">list_all_surfaces</span><span class="p">()</span>
</pre></div>
</div>
<p>Function <code class="docutils literal notranslate"><span class="pre">create_scene()</span></code> creates default VPython canvas with some settings, which can be specified providing additional parameters to function:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">axes:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></code> — add axes to scene (<code class="docutils literal notranslate"><span class="pre">True</span></code> by default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">width:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">1200</span></code> — set width for visualization window in browser in pixels (<code class="docutils literal notranslate"><span class="pre">1200</span></code> pixels by default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">height:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">800</span></code> — set height for visualization window in browser in pixels (<code class="docutils literal notranslate"><span class="pre">800</span></code> pixels by default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">resizable:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></code> — makes window resizable or not (<code class="docutils literal notranslate"><span class="pre">True</span></code> by default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ax_length:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">2.0</span></code> — axes length, it is better to set as maximum size of the whole geometry (<code class="docutils literal notranslate"><span class="pre">2.0</span></code> by default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ax_opacity:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">0.2</span></code> — set axes opacity, where <code class="docutils literal notranslate"><span class="pre">1.0</span></code> is fully visible and <code class="docutils literal notranslate"><span class="pre">0.0</span></code> — fully transparent (<code class="docutils literal notranslate"><span class="pre">0.2</span></code> by default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">background:</span> <span class="pre">vpython.vector</span> <span class="pre">=</span> <span class="pre">GRAY_SCALE[1]</span></code> — set background color for scene (by default it is predefined <code class="docutils literal notranslate"><span class="pre">LIGHTGRAY</span></code> color from <code class="docutils literal notranslate"><span class="pre">const</span></code> module)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">return</span></code> — <code class="docutils literal notranslate"><span class="pre">vpython.canvas</span></code> object</p></li>
</ul>
<p>To create empty scene with default settings:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">scene</span> <span class="o">=</span> <span class="n">fitsgeo</span><span class="o">.</span><span class="n">create_scene</span><span class="p">()</span>
</pre></div>
</div>
<div class="align-center figure" id="id9">
<img alt="{{ base_path }}/fitsgeo/_images/empty_scene.png" src="{{ base_path }}/fitsgeo/_images/empty_scene.png" />
<p class="caption"><span class="caption-text"><strong>Default empty scene with axes</strong></span><a class="headerlink" href="#id9" title="Permalink to this image">¶</a></p>
</div>
<p>After that, every created surface will be drawn on this scene. Scene automatically opens in browser.</p>
<p>Control of view:</p>
<ul class="simple">
<li><p><strong>zoom:</strong> mouse wheel</p></li>
<li><p><strong>rotate:</strong> right mouse button (ctrl+left mouse button)</p></li>
<li><p><strong>pan:</strong> shift+left mouse button</p></li>
</ul>
<p>Scene is a 3D VPython canvas, take a look at <a class="reference external" href="https://www.glowscript.org/docs/VPythonDocs/canvas.html">VPython docs</a> for more detailed explanation.</p>
<p>To create surfaces, one must create object from corresponding surface class. Table below shows which Python classes for PHITS surfaces are currently implemented.</p>
<div class="toggle-header docutils container">
<p><strong>Table: PHITS surfaces — FitsGeo classes</strong></p>
</div>
<div class="toggle-content docutils container">
<blockquote>
<div><table class="longtable docutils align-default" id="id10">
<caption><span class="caption-text"><strong>PHITS surfaces — FitsGeo classes</strong></span><a class="headerlink" href="#id10" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 29%" />
<col style="width: 16%" />
<col style="width: 35%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>PHITS surface symbol</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Explanation</p></th>
<th class="head"><p>Class</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>P</p></td>
<td rowspan="4"><p>planes</p></td>
<td><p>multi-purpose</p></td>
<td rowspan="4"><p><code class="docutils literal notranslate"><span class="pre">P</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>PX</p></td>
<td><p>vertical with X-axis</p></td>
</tr>
<tr class="row-even"><td><p>PY</p></td>
<td><p>vertical with Y-axis</p></td>
</tr>
<tr class="row-odd"><td><p>PZ</p></td>
<td><p>vertical with Z-axis</p></td>
</tr>
<tr class="row-even"><td><p>SO</p></td>
<td rowspan="5"><p>sphere</p></td>
<td><p>origin is center</p></td>
<td rowspan="6"><p><code class="docutils literal notranslate"><span class="pre">SPH</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>S</p></td>
<td><p>multi-purpose</p></td>
</tr>
<tr class="row-even"><td><p>SX</p></td>
<td><p>center on X-axis</p></td>
</tr>
<tr class="row-odd"><td><p>SY</p></td>
<td><p>center on Y-axis</p></td>
</tr>
<tr class="row-even"><td><p>SZ</p></td>
<td><p>center on Z-axis</p></td>
</tr>
<tr class="row-odd"><td><p>SPH</p></td>
<td><p>macro body</p></td>
<td><p>same as multi-purpose</p></td>
</tr>
<tr class="row-even"><td><p>BOX</p></td>
<td><p>macro body</p></td>
<td><p>optional BOX</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">BOX</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>RPP</p></td>
<td><p>macro body</p></td>
<td><p>rectangular solid similar
to BOX, but each surface
is vertical with
x, y, z axes</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">RPP</span></code></p></td>
</tr>
<tr class="row-even"><td><p>RCC</p></td>
<td><p>macro body</p></td>
<td><p>cylinder</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">RCC</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>TRC</p></td>
<td><p>macro body</p></td>
<td><p>truncated right-angle
cone</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TRC</span></code></p></td>
</tr>
<tr class="row-even"><td><p>TX</p></td>
<td rowspan="3"><p>ellipse
torus</p></td>
<td><p>parallel with X-axis</p></td>
<td rowspan="3"><p><code class="docutils literal notranslate"><span class="pre">T</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>TY</p></td>
<td><p>parallel with Y-axis</p></td>
</tr>
<tr class="row-even"><td><p>TZ</p></td>
<td><p>parallel with Z-axis</p></td>
</tr>
<tr class="row-odd"><td><p>REC</p></td>
<td><p>macro body</p></td>
<td><p>right elliptical cylinder</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">REC</span></code></p></td>
</tr>
<tr class="row-even"><td><p>WED</p></td>
<td><p>macro body</p></td>
<td><p>wedge</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">WED</span></code></p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<p>Therefore, from each class surface objects can be created. For example, to create box surface object of <code class="docutils literal notranslate"><span class="pre">BOX</span></code> class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">box</span> <span class="o">=</span> <span class="n">fitsgeo</span><span class="o">.</span><span class="n">BOX</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Box&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This line creates <code class="docutils literal notranslate"><span class="pre">box</span></code> object from <code class="docutils literal notranslate"><span class="pre">BOX</span></code> class at <span class="math notranslate nohighlight">\(P (0, 0, 0)\)</span> (base point) coordinate and <span class="math notranslate nohighlight">\(\vec{A} \langle1, 0, 0\rangle\)</span>, <span class="math notranslate nohighlight">\(\vec{B} \langle0, 1, 0\rangle\)</span>, <span class="math notranslate nohighlight">\(\vec{C} \langle0, 0, 1\rangle\)</span> vectors from base point with “Box” name.</p>
<p>All classes have default parameters, so, the above object may be simply created as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">box</span> <span class="o">=</span> <span class="n">fitsgeo</span><span class="o">.</span><span class="n">BOX</span><span class="p">()</span>
</pre></div>
</div>
<p>Other objects can be created in the same manner. All parameters for all implemented classes listed in the table below.</p>
<div class="toggle-header docutils container">
<p><strong>Table: parameters of surface classes</strong></p>
</div>
<div class="toggle-content docutils container">
<blockquote>
<div><table class="longtable docutils align-default" id="id11">
<caption><span class="caption-text"><strong>Parameters of surface classes</strong></span><a class="headerlink" href="#id11" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 27%" />
<col style="width: 19%" />
<col style="width: 54%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Class</p></th>
<th class="head"><p>Parameter</p></th>
<th class="head"><p>Explanation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="5"><p><code class="docutils literal notranslate"><span class="pre">P</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a:</span> <span class="pre">float</span></code></p></td>
<td rowspan="4"><p>parameters in <span class="math notranslate nohighlight">\(Ax + By + Cz - D = 0\)</span>
equation</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">b:</span> <span class="pre">float</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">c:</span> <span class="pre">float</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">d:</span> <span class="pre">float</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">vert:</span> <span class="pre">str</span></code></p></td>
<td><p>axis to which plane
is vertical (<code class="docutils literal notranslate"><span class="pre">&quot;x&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;y&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;z&quot;</span></code>)</p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><p><code class="docutils literal notranslate"><span class="pre">SPH</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">xyz0:</span> <span class="pre">list</span></code></p></td>
<td><p>center coordinate of
sphere as [x0, y0, z0] list</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">r:</span> <span class="pre">float</span></code></p></td>
<td><p>radius of sphere</p></td>
</tr>
<tr class="row-odd"><td rowspan="4"><p><code class="docutils literal notranslate"><span class="pre">BOX</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">xyz0:</span> <span class="pre">list</span></code></p></td>
<td><p>base point coordinate
as [x0, y0, z0] list</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">a:</span> <span class="pre">list</span></code></p></td>
<td><p>vector <span class="math notranslate nohighlight">\(\vec{A}\)</span> from base point to
first face as [Ax, Ay, Az] list</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">b:</span> <span class="pre">list</span></code></p></td>
<td><p>vector <span class="math notranslate nohighlight">\(\vec{B}\)</span> from base point to second
face as [Bx, By, Bz] list</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">c:</span> <span class="pre">list</span></code></p></td>
<td><p>vector <span class="math notranslate nohighlight">\(\vec{C}\)</span> from base point to third
face as [Cx, Cy, Cz] list</p></td>
</tr>
<tr class="row-odd"><td rowspan="3"><p><code class="docutils literal notranslate"><span class="pre">RPP</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">x:</span> <span class="pre">list</span></code></p></td>
<td><p>list with x min and max components
as [x_min, x_max] list</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">y:</span> <span class="pre">list</span></code></p></td>
<td><p>list with y min and max components
as [y_min, y_max] list</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">z:</span> <span class="pre">list</span></code></p></td>
<td><p>list with z min and max components
as [z_min, z_max] list</p></td>
</tr>
<tr class="row-even"><td rowspan="3"><p><code class="docutils literal notranslate"><span class="pre">RCC</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">xyz0:</span> <span class="pre">list</span></code></p></td>
<td><p>center coordinate of bottom face
as [x0, y0, z0] list</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">h:</span> <span class="pre">list</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\vec{H}\)</span> from the bottom face to the top
as [Hx, Hy, Hz] list</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">r:</span> <span class="pre">float</span></code></p></td>
<td><p>radius of bottom face</p></td>
</tr>
<tr class="row-odd"><td rowspan="4"><p><code class="docutils literal notranslate"><span class="pre">TRC</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">xyz0:</span> <span class="pre">list</span></code></p></td>
<td><p>center coordinate of cone bottom
face as [x0, y0, z0] list</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">h:</span> <span class="pre">list</span></code></p></td>
<td><p>height <span class="math notranslate nohighlight">\(\vec{H}\)</span> from center of bottom face
to the top face as [Hx, Hy, Hz] list</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">r_1:</span> <span class="pre">float</span></code></p></td>
<td><p>radius of bottom face of
truncated cone</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">r_2:</span> <span class="pre">float</span></code></p></td>
<td><p>radius of top face of truncated cone</p></td>
</tr>
<tr class="row-odd"><td rowspan="5"><p><code class="docutils literal notranslate"><span class="pre">T</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">xyz0:</span> <span class="pre">list</span></code></p></td>
<td><p>center of the torus
as [x0, y0, z0] list</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">r:</span> <span class="pre">float</span></code></p></td>
<td><p>distance between torus center
(rotational axis) and ellipse center</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">b:</span> <span class="pre">float</span></code></p></td>
<td><p>semi-minor axis value
(ellipse half “height”)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">c:</span> <span class="pre">float</span></code></p></td>
<td><p>semi-major axis value
(ellipse half “width”)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">rot:</span> <span class="pre">str</span></code></p></td>
<td><p>rotational axis (<code class="docutils literal notranslate"><span class="pre">&quot;x&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;y&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;z&quot;</span></code>)</p></td>
</tr>
<tr class="row-even"><td rowspan="4"><p><code class="docutils literal notranslate"><span class="pre">REC</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">xyz0:</span> <span class="pre">list</span></code></p></td>
<td><p>center coordinate of bottom face
as [x0, y0, z0] list</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">h:</span> <span class="pre">list</span></code></p></td>
<td><p>height <span class="math notranslate nohighlight">\(\vec{H}\)</span> from center of bottom</p>
<p>face as [Hx, Hy, Hz] list</p>
</td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">a:</span> <span class="pre">list</span></code></p></td>
<td><p>semi-major axis <span class="math notranslate nohighlight">\(\vec{A}\)</span> of ellipse
orthogonal to <span class="math notranslate nohighlight">\(\vec{H}\)</span> as [Ax, Ay, Az] list</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">b:</span> <span class="pre">list</span></code></p></td>
<td><p>semi-minor axis <span class="math notranslate nohighlight">\(\vec{B}\)</span> of ellipse
orthogonal to <span class="math notranslate nohighlight">\(\vec{H}\)</span> and <span class="math notranslate nohighlight">\(\vec{A}\)</span> as
[Bx, By, Bz] list</p></td>
</tr>
<tr class="row-even"><td rowspan="4"><p><code class="docutils literal notranslate"><span class="pre">WED</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">xyz0:</span> <span class="pre">list</span></code></p></td>
<td><p>base vertex coordinate
as [x0, y0, z0] list</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">a:</span> <span class="pre">list</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\vec{A}\)</span> to first side of triangle
as [Ax, Ay, Az] list</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">b:</span> <span class="pre">list</span></code></p></td>
<td><p><span class="math notranslate nohighlight">\(\vec{B}\)</span> to second side of triangle
as [Bx, By, Bz] list</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">h:</span> <span class="pre">list</span></code></p></td>
<td><p>height vector <span class="math notranslate nohighlight">\(\vec{H}\)</span> from base vertex
as [Hx, Hy, Hz] list</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<p>In addition to listed in the table above parameters, each class have common from <code class="docutils literal notranslate"><span class="pre">Surface</span></code> super class parameters/properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name:</span> <span class="pre">str</span></code> — name for object, for user convenience, appears in commentaries in PHITS input</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">trn:</span> <span class="pre">str</span></code> — transform number, specifies the number n of TRn in PHTIS [ Transform ] section (in current version transformations not visualizable)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">material:</span> <span class="pre">fitsgeo.Material</span></code> — material associated with surface, object from <code class="docutils literal notranslate"><span class="pre">Material</span></code> class, by default predefined <code class="docutils literal notranslate"><span class="pre">MAT_WATER</span></code> material is used from <code class="docutils literal notranslate"><span class="pre">const</span></code> module</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sn:</span> <span class="pre">int</span></code> — surface object number, automatically set after every new surface initialization, but can be changed manually after initialization</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">color:</span> <span class="pre">vpython.vector</span></code> — <code class="docutils literal notranslate"><span class="pre">vpython.vector</span></code> object, which defines color for surface (associated with ANGEL color through <code class="docutils literal notranslate"><span class="pre">ANGEL_COLORS</span></code> dictionary from <code class="docutils literal notranslate"><span class="pre">const</span></code> module by default), not accessible at initialization</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">opacity:</span> <span class="pre">float</span></code> — surface opacity during visualization, from <code class="docutils literal notranslate"><span class="pre">0.0</span></code> (fully transparent) to <code class="docutils literal notranslate"><span class="pre">1.0</span></code> (fully visable), not accessible at initialization</p></li>
</ul>
<p>Each class have number of getter/setter methods. They define unique for each class properties in addition to parameters from table above: area surfaces, volumes, diameters etc. All methods are listed in the table below.</p>
<div class="toggle-header docutils container">
<p><strong>Table: all methods for surface classes</strong></p>
</div>
<div class="toggle-content docutils container">
<blockquote>
<div><table class="longtable docutils align-default" id="id12">
<caption><span class="caption-text"><strong>All methods for surface classes</strong></span><a class="headerlink" href="#id12" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 22%" />
<col style="width: 16%" />
<col style="width: 42%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Class</p></th>
<th class="head"><p>Method</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Explanation</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="5"><p><code class="docutils literal notranslate"><span class="pre">SPH</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">diameter</span></code></p></td>
<td><p>Getter &amp; Setter</p></td>
<td><p>Get/set sphere diameter (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">volume</span></code></p></td>
<td><p>Getter &amp; Setter</p></td>
<td><p>Get/set sphere volume (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">surface_area</span></code></p></td>
<td><p>Getter &amp; Setter</p></td>
<td><p>Get/set full surface area (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">cross_section</span></code></p></td>
<td><p>Getter &amp; Setter</p></td>
<td><p>Get/set cross section area: circle (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">circumference</span></code></p></td>
<td><p>Getter &amp; Setter</p></td>
<td><p>Get/set circumference of cross section (float)</p></td>
</tr>
<tr class="row-odd"><td rowspan="11"><p><code class="docutils literal notranslate"><span class="pre">BOX</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">get_center</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get center of <code class="docutils literal notranslate"><span class="pre">BOX</span></code> object as [xc, yc, zc]</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_diagonal</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get diagonal <span class="math notranslate nohighlight">\(\vec{D}\)</span> [xd, yd, zd] as list</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_diagonal_length</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get diagonal length <span class="math notranslate nohighlight">\(|\vec{D}|\)</span> (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_len_a</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get length of <span class="math notranslate nohighlight">\(\vec{A}\)</span> (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_len_b</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get length of <span class="math notranslate nohighlight">\(\vec{B}\)</span> (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_len_c</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get length of <span class="math notranslate nohighlight">\(\vec{C}\)</span> (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_volume</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get volume of <code class="docutils literal notranslate"><span class="pre">BOX</span></code> object (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_ab_area</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get <span class="math notranslate nohighlight">\(|\vec{A}\times\vec{B}|\)</span> area (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_ac_area</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get <span class="math notranslate nohighlight">\(|\vec{A}\times\vec{C}|\)</span> area (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_bc_area</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get <span class="math notranslate nohighlight">\(|\vec{B}\times\vec{C}|\)</span> area (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_full_area</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get full surface area (float)</p></td>
</tr>
<tr class="row-even"><td rowspan="10"><p><code class="docutils literal notranslate"><span class="pre">RPP</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">get_width</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get width of <code class="docutils literal notranslate"><span class="pre">RPP</span></code> object (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_height</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get height of <code class="docutils literal notranslate"><span class="pre">RPP</span></code> object (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_length</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get length of <code class="docutils literal notranslate"><span class="pre">RPP</span></code> object (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_center</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get center as [xc, yc, zc] list</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_diagonal_length</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get diagonal length (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_volume</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get volume of <code class="docutils literal notranslate"><span class="pre">RPP</span></code> object (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_wh_area</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get width <span class="math notranslate nohighlight">\(\times\)</span> height face area (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_wl_area</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get width <span class="math notranslate nohighlight">\(\times\)</span> length face area (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_hl_area</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get height <span class="math notranslate nohighlight">\(\times\)</span> length face area (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_full_area</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get full surface area (float)</p></td>
</tr>
<tr class="row-even"><td rowspan="8"><p><code class="docutils literal notranslate"><span class="pre">RCC</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">diameter</span></code></p></td>
<td><p>Getter &amp; Setter</p></td>
<td><p>Get/set bottom/top faces diameter (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">circumference</span></code></p></td>
<td><p>Getter &amp; Setter</p></td>
<td><p>Get/set bottom/top faces circumference (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bottom_area</span></code></p></td>
<td><p>Getter &amp; Setter</p></td>
<td><p>Get/set bottom area of cylinder (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_center</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get center of cylinder as [xc, yc, zc] list</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_len_h</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get height length <span class="math notranslate nohighlight">\(|\vec{H}|\)</span> (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_volume</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get volume of <code class="docutils literal notranslate"><span class="pre">RCC</span></code> object (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_side_area</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get side surface area (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_full_area</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get full surface area (float)</p></td>
</tr>
<tr class="row-even"><td rowspan="12"><p><code class="docutils literal notranslate"><span class="pre">TRC</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bottom_diameter</span></code></p></td>
<td><p>Getter &amp; Setter</p></td>
<td><p>Get/set bottom face diameter (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">top_diameter</span></code></p></td>
<td><p>Getter &amp; Setter</p></td>
<td><p>Get/set top face diameter (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bottom_circumference</span></code></p></td>
<td><p>Getter &amp; Setter</p></td>
<td><p>Get/set bottom face circumference (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">top_circumference</span></code></p></td>
<td><p>Getter &amp; Setter</p></td>
<td><p>Get/set top face circumference (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">bottom_area</span></code></p></td>
<td><p>Getter &amp; Setter</p></td>
<td><p>Get/set bottom face area (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">top_area</span></code></p></td>
<td><p>Getter &amp; Setter</p></td>
<td><p>Get/set top face area (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_center</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get center as [xc, yc, zc] list</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_len_h</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get height <span class="math notranslate nohighlight">\(|\vec{H}|\)</span> (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_forming</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get cone forming (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_volume</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get volume of <code class="docutils literal notranslate"><span class="pre">TRC</span></code> object (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_side_area</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get side surface area (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_full_area</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get full surface area of cone (float)</p></td>
</tr>
<tr class="row-even"><td rowspan="4"><p><code class="docutils literal notranslate"><span class="pre">T</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">circumference</span></code></p></td>
<td><p>Getter &amp; Setter</p></td>
<td><p>Get/set torus circumference (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_cross_section</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get cross section area of torus (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_full_area</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get full surface area of torus (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_volume</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get volume of torus (float)</p></td>
</tr>
<tr class="row-even"><td rowspan="8"><p><code class="docutils literal notranslate"><span class="pre">REC</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">get_center</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get center of elliptical cylinder
as [xc, yc, zc] list</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_len_h</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get height <span class="math notranslate nohighlight">\(|\vec{H}|\)</span> (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_len_a</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get semi-major axis length <span class="math notranslate nohighlight">\(|\vec{A}|\)</span> (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_len_b</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get semi-minor axis length <span class="math notranslate nohighlight">\(|\vec{B}|\)</span> (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_bottom_area</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get bottom (top) face area
of elliptical cylinder (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_side_area</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get side surface area (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_full_area</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get full surface area (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_volume</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get volume of elliptical cylinder (float)</p></td>
</tr>
<tr class="row-even"><td rowspan="11"><p><code class="docutils literal notranslate"><span class="pre">WED</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">get_center</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get wedge centroid as [xc, yc, zc] list</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_len_a</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get <span class="math notranslate nohighlight">\(|\vec{A}|\)</span> (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_len_b</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get <span class="math notranslate nohighlight">\(|\vec{B}|\)</span> (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_len_h</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get <span class="math notranslate nohighlight">\(|\vec{H}|\)</span> (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_len_c</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get <span class="math notranslate nohighlight">\(\sqrt{a^2 + b^2}\)</span> (float),
where a = <span class="math notranslate nohighlight">\(|\vec{A}|\)</span>, b = <span class="math notranslate nohighlight">\(|\vec{B}|\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_volume</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get wedge volume (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_ab_area</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get <span class="math notranslate nohighlight">\(|\vec{A}\times\vec{B}|/2\)</span>
bottom/top triangle face area (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_ah_area</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get <span class="math notranslate nohighlight">\(|\vec{A}\times\vec{H}|\)</span> face area (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_bh_area</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get <span class="math notranslate nohighlight">\(|\vec{B}\times\vec{H}|\)</span> face area (float)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">get_ch_area</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get opposite to <span class="math notranslate nohighlight">\(\vec{H}\)</span>
rectangle face area (float)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">get_full_area</span></code></p></td>
<td><p>Getter</p></td>
<td><p>Get full surface area (float)</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
</div>
<p>Each getter method starts with <code class="docutils literal notranslate"><span class="pre">get_</span></code> prefix. If method doesn’t have this prefix, then method also has setter.</p>
<p>In addition to listed in the table above methods, each class have common methods:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">print_properties()</span></code> — prints all properties of object in console</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">phits_print()</span></code> — returns string with PHITS definition of object</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">draw()</span></code> — draws VPython representation of defined object on current scene, additional parameters may be provided to this method:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">size:</span> <span class="pre">float</span></code> — defines size of plane (only for <code class="docutils literal notranslate"><span class="pre">P</span></code> class)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">opacity:</span> <span class="pre">float</span></code> — defines surface opacity during visualization, from <code class="docutils literal notranslate"><span class="pre">0.0</span></code> (fully transparent) to <code class="docutils literal notranslate"><span class="pre">1.0</span></code> (fully visible), <strong>note that</strong> if material parameter <code class="docutils literal notranslate"><span class="pre">gas=True</span></code>, then opacity will be set to <code class="docutils literal notranslate"><span class="pre">0.2</span></code> automatically, planes by default have <code class="docutils literal notranslate"><span class="pre">0.2</span></code> opacity</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">label:</span> <span class="pre">bool</span></code> — defines whether to show label (text with some description) on <strong>plane surface</strong> during visualization or not</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">label_center:</span> <span class="pre">bool</span></code> — defines whether to show label of object’s center (except planes) during visualization or not</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">label_base:</span> <span class="pre">bool</span></code> — defines whether to show label of object’s base point (if object has it) during visualization or not</p></li>
</ul>
</div></blockquote>
</li>
</ul>
<p>For example, to print all properties of object in console:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">box</span><span class="o">.</span><span class="n">print_properties</span><span class="p">()</span>
</pre></div>
</div>
<p>To get PHITS definition of object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">export_line</span> <span class="o">=</span> <span class="n">box</span><span class="o">.</span><span class="n">phits_print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">export_line</span><span class="p">)</span>   <span class="c1"># Print definition in console</span>
</pre></div>
</div>
<p>To draw box object on scene with labels pointing on box’s base point and center:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">box</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">label_base</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label_center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div class="align-center figure" id="id13">
<img alt="{{ base_path }}/fitsgeo/_images/scene_box.png" src="{{ base_path }}/fitsgeo/_images/scene_box.png" />
<p class="caption"><span class="caption-text"><strong>Box surface drawn on scene with center and base labels</strong></span><a class="headerlink" href="#id13" title="Permalink to this image">¶</a></p>
</div>
<p>To get full surface area of box object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">area</span> <span class="o">=</span> <span class="n">box</span><span class="o">.</span><span class="n">get_full_area</span>
</pre></div>
</div>
<p>Or, to get volume of box object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">volume</span> <span class="o">=</span> <span class="n">box</span><span class="o">.</span><span class="n">get_volume</span>
</pre></div>
</div>
<p>To redefine <code class="docutils literal notranslate"><span class="pre">xyz0</span></code> parameter of box object:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">box</span><span class="o">.</span><span class="n">xyz0</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
</pre></div>
</div>
<p>To redefine only x component from <code class="docutils literal notranslate"><span class="pre">xyz0</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">box</span><span class="o">.</span><span class="n">xyz0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">box</span><span class="o">.</span><span class="n">x0</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>Similar way can be applied to other objects, using other methods.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">SPH</span></code> class all methods represented both as getter and setter methods. This means, that user can define or get any property. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sphere</span> <span class="o">=</span> <span class="n">fitsgeo</span><span class="o">.</span><span class="n">SPH</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Create sphere object from SPH class</span>
<span class="n">sphere</span><span class="o">.</span><span class="n">volume</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Set volume to 1</span>
</pre></div>
</div>
<p>Last line will make <code class="docutils literal notranslate"><span class="pre">r</span></code> (radius) parameter of <code class="docutils literal notranslate"><span class="pre">sphere</span></code> correspond to defined volume. Same works for all other methods in <code class="docutils literal notranslate"><span class="pre">SPH</span></code> class.</p>
<p>To get value of property:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">volume</span> <span class="o">=</span> <span class="n">sphere</span><span class="o">.</span><span class="n">volume</span>  <span class="c1"># Get volume of sphere</span>
</pre></div>
</div>
<p>Similarly, user can redefine radius of sphere according to any other defined property.</p>
<p>Surface module have a global <code class="docutils literal notranslate"><span class="pre">created_surfaces</span></code> list, this list contains all initialized surfaces. This way, all surfaces could be easily accessed from this list and modified, or, for example, drawn all together:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">surface</span> <span class="ow">in</span> <span class="n">created_surfaces</span><span class="p">:</span>
        <span class="n">surface</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</div>
<p>This command will draw all created surfaces.</p>
</div>
<div class="section" id="id5">
<h3>Cell module<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>This module provides <code class="docutils literal notranslate"><span class="pre">Cell</span></code> class for cells definition. Example of basic cell:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">box_cell</span> <span class="o">=</span> <span class="n">fitsgeo</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span>
        <span class="p">[</span><span class="o">-</span><span class="n">box</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Box Cell&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">fitsgeo</span><span class="o">.</span><span class="n">MAT_WATER</span><span class="p">))</span>
</pre></div>
</div>
<p>Parameters in <code class="docutils literal notranslate"><span class="pre">Cell</span></code> class:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cell_def:</span> <span class="pre">list</span></code> — list with regions and the Boolean operators, <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">&quot;</span></code> (blank)(AND), <code class="docutils literal notranslate"><span class="pre">&quot;:&quot;</span></code> (OR), and <code class="docutils literal notranslate"><span class="pre">&quot;#&quot;</span></code> (NOT). Parentheses <code class="docutils literal notranslate"><span class="pre">&quot;(&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;)&quot;</span></code> will be added automatically for regions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">&quot;Cell&quot;</span></code> — name for cell object</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">material:</span> <span class="pre">fitsgeo.Material</span> <span class="pre">=</span> <span class="pre">fitsgeo.MAT_WATER</span></code> — material associated with cell (predefined <code class="docutils literal notranslate"><span class="pre">MAT_WATER</span></code> material by default)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">volume:</span> <span class="pre">float</span> <span class="pre">=</span> <span class="pre">None</span></code> — volume [cm<span class="math notranslate nohighlight">\(^3\)</span>] of the cell</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cn:</span> <span class="pre">int</span></code> — cell object number, automatically set after every new cell initialization, but can be changed manually after initialization (number for cells start from <code class="docutils literal notranslate"><span class="pre">100</span></code>)</p></li>
</ul>
<p>Cells are defined by treating regions divided by surfaces. Surface classes have overloaded <code class="docutils literal notranslate"><span class="pre">&quot;+&quot;</span></code> (<code class="docutils literal notranslate"><span class="pre">__pos__</span></code>) and <code class="docutils literal notranslate"><span class="pre">&quot;-&quot;</span></code> (<code class="docutils literal notranslate"><span class="pre">__neg__</span></code>) operators, this provides capability to define “surface sense” (see <a class="reference external" href="https://phits.jaea.go.jp/rireki-manuale.html">PHITS manual</a>). These operators return surface numbers of surface objects as strings.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="o">-</span><span class="n">box</span><span class="p">)</span>  <span class="c1"># Print string &quot;-sn&quot;, where sn is a box.sn</span>
<span class="nb">print</span><span class="p">(</span><span class="o">+</span><span class="n">box</span><span class="p">)</span>  <span class="c1"># Print string &quot;sn&quot;, where sn is a box.sn</span>

<span class="n">region1</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">box</span><span class="p">]</span>  <span class="c1"># Defines negative sense of box object (inner space)</span>
<span class="n">region2</span> <span class="o">=</span> <span class="p">[</span><span class="o">+</span><span class="n">box</span><span class="p">]</span>  <span class="c1"># Defines positive sense of box object (outer space)</span>
</pre></div>
</div>
<p>The symbols <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">&quot;</span></code> (blank), <code class="docutils literal notranslate"><span class="pre">&quot;:&quot;</span></code>, and <code class="docutils literal notranslate"><span class="pre">&quot;#&quot;</span></code> denote the intersection (AND), union (OR), and complement (NOT), operators, respectively. Let’s say that we have multiple objects (<code class="docutils literal notranslate"><span class="pre">box</span></code> and <code class="docutils literal notranslate"><span class="pre">sphere</span></code>) and we want to make cell with union of these surfaces:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fitsgeo</span>

<span class="c1"># Create default scene</span>
<span class="n">fitsgeo</span><span class="o">.</span><span class="n">create_scene</span><span class="p">()</span>

<span class="n">box</span> <span class="o">=</span> <span class="n">fitsgeo</span><span class="o">.</span><span class="n">BOX</span><span class="p">()</span>  <span class="c1"># Box surface</span>
<span class="n">sphere</span> <span class="o">=</span> <span class="n">fitsgeo</span><span class="o">.</span><span class="n">SPH</span><span class="p">()</span>  <span class="c1"># Sphere surface</span>

<span class="c1"># Define outer void cell</span>
<span class="n">outer_cell</span> <span class="o">=</span> <span class="n">fitsgeo</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span>
        <span class="p">[</span><span class="o">+</span><span class="n">box</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="o">+</span><span class="n">sphere</span><span class="p">],</span>
        <span class="n">material</span><span class="o">=</span><span class="n">fitsgeo</span><span class="o">.</span><span class="n">MAT_OUTER</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Outer Void&quot;</span><span class="p">)</span>
<span class="c1"># Define union of objects</span>
<span class="n">cell</span> <span class="o">=</span> <span class="n">fitsgeo</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span>
        <span class="p">[</span><span class="o">-</span><span class="n">box</span><span class="p">,</span> <span class="s2">&quot;:&quot;</span><span class="p">,</span> <span class="o">-</span><span class="n">sphere</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Union&quot;</span><span class="p">)</span>

<span class="n">sphere</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">fitsgeo</span><span class="o">.</span><span class="n">YELLOW</span>  <span class="c1"># Just to make different colors</span>

<span class="c1"># Draw half transparent</span>
<span class="n">box</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">sphere</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">fitsgeo</span><span class="o">.</span><span class="n">phits_export</span><span class="p">()</span>  <span class="c1"># Export sections to PHITS</span>
</pre></div>
</div>
<p>The result of visualization in FitsGeo is on the image below.</p>
<div class="align-center figure" id="id14">
<img alt="{{ base_path }}/fitsgeo/_images/fitsgeo_union.png" src="{{ base_path }}/fitsgeo/_images/fitsgeo_union.png" />
<p class="caption"><span class="caption-text"><strong>Cell as the union of box and sphere (FitsGeo visualization)</strong></span><a class="headerlink" href="#id14" title="Permalink to this image">¶</a></p>
</div>
<p>In the FitsGeo visualization we will always see our surfaces, not cells, but after export of generated sections to PHITS and visualization using ANGEL, this will be like on the image below.</p>
<div class="align-center figure" id="id15">
<img alt="{{ base_path }}/fitsgeo/_images/cell_union.png" src="{{ base_path }}/fitsgeo/_images/cell_union.png" />
<p class="caption"><span class="caption-text"><strong>Cell as the union of box and sphere (ANGEL visualization)</strong></span><a class="headerlink" href="#id15" title="Permalink to this image">¶</a></p>
</div>
<p>Exported sections to PHITS, as well as the full input file are presented below.</p>
<div class="toggle-header docutils container">
<p><strong>Exported from FitsGeo PHITS sections</strong></p>
</div>
<div class="toggle-content docutils container">
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[ Material ]
    mat[1] H 2.0 O 1.0  GAS=0 $ name: &#39;MAT_WATER&#39;

[ Mat Name Color ]
        mat     name    size    color
        1       {MAT\_WATER}    1.00    blue

[ Surface ]
    1   BOX  0.0 0.0 0.0  1.0 0.0 0.0  0.0 1.0 0.0  0.0 0.0 1.0 $ name: &#39;BOX&#39; (box, all angles are 90deg) [x0 y0 z0] [Ax Ay Az] [Bx By Bz] [Cx Cy Cz]
    2   SPH  0.0 0.0 0.0  1.0 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R

[ Cell ]
    100 -1  (1):(2) $ name: &#39;Outer Void&#39;

    101 1  1.0  (-1):(-2)   $ name: &#39;Union&#39;
</pre></div>
</div>
</div></blockquote>
</div>
<div class="toggle-header docutils container">
<p><strong>Full PHITS input file</strong></p>
</div>
<div class="toggle-content docutils container">
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[ Parameters ]
        icntl = 11              # (D=0) 3:ECH 5:ALL VOID 6:SRC 7,8:GSH 11:DSH 12:DUMP

[ Source ]
        s-type = 2              # mono-energetic rectangular source
        e0 = 1                  # energy of beam [MeV]
        proj = proton   # kind of incident particle

[ Material ]
    mat[1] H 2.0 O 1.0  GAS=0 $ name: &#39;MAT_WATER&#39;

[ Mat Name Color ]
        mat     name    size    color
        1       {MAT\_WATER}    1.00    blue

[ Surface ]
    1   BOX  0.0 0.0 0.0  1.0 0.0 0.0  0.0 1.0 0.0  0.0 0.0 1.0 $ name: &#39;BOX&#39; (box, all angles are 90deg) [x0 y0 z0] [Ax Ay Az] [Bx By Bz] [Cx Cy Cz]
    2   SPH  0.0 0.0 0.0  1.0 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R

[ Cell ]
    100 -1  (1):(2) $ name: &#39;Outer Void&#39;

    101 1  1.0  (-1):(-2)   $ name: &#39;Union&#39;

[ T-3Dshow ]
        title = Geometry 3D
        x0 = 0
        y0 = 0
        z0 = 0

        w-wdt = 3
        w-hgt = 3
        w-dst = 10

        w-mnw = 400                     # Number of meshes in horizontal direction.
        w-mnh = 400                     # Number of meshes in vertical direction.
        w-ang = 0

        e-the = -45
        e-phi = 24
        e-dst = 100

        l-the = 80
        l-phi = 140
        l-dst = 200*100

        file = example1_3D
        output = 3                      # (D=3) Region boundary + color
        width = 0.5                     # (D=0.5) The option defines the line thickness.
        epsout = 1

[ E n d ]
</pre></div>
</div>
</div></blockquote>
</div>
<p>Or, we can define cells as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fitsgeo</span>

<span class="n">fitsgeo</span><span class="o">.</span><span class="n">create_scene</span><span class="p">()</span>

<span class="n">box</span> <span class="o">=</span> <span class="n">fitsgeo</span><span class="o">.</span><span class="n">BOX</span><span class="p">()</span>
<span class="n">sphere</span> <span class="o">=</span> <span class="n">fitsgeo</span><span class="o">.</span><span class="n">SPH</span><span class="p">()</span>

<span class="c1"># Define outer void</span>
<span class="n">outer_cell</span> <span class="o">=</span> <span class="n">fitsgeo</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span>
        <span class="p">[</span><span class="o">+</span><span class="n">box</span> <span class="o">+</span> <span class="o">+</span><span class="n">sphere</span><span class="p">],</span>
        <span class="n">material</span><span class="o">=</span><span class="n">fitsgeo</span><span class="o">.</span><span class="n">MAT_OUTER</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Outer Void&quot;</span><span class="p">)</span>
<span class="c1"># Intersection of inner part of box and outer part of sphere</span>
<span class="n">cell_box</span> <span class="o">=</span> <span class="n">fitsgeo</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">-</span><span class="n">box</span> <span class="o">+</span> <span class="o">+</span><span class="n">sphere</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Intersection&quot;</span><span class="p">)</span>
<span class="c1"># Inner part of sphere</span>
<span class="n">cell_sphere</span> <span class="o">=</span> <span class="n">fitsgeo</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span>
        <span class="p">[</span><span class="o">-</span><span class="n">sphere</span><span class="p">],</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Inner Sphere&quot;</span><span class="p">,</span>
        <span class="n">material</span><span class="o">=</span><span class="n">fitsgeo</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_WATER&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;yellow&quot;</span><span class="p">))</span>

<span class="n">sphere</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="n">fitsgeo</span><span class="o">.</span><span class="n">YELLOW</span>  <span class="c1"># Just to make different colors</span>

<span class="n">box</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">sphere</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">opacity</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">fitsgeo</span><span class="o">.</span><span class="n">phits_export</span><span class="p">()</span>  <span class="c1"># Export sections</span>
</pre></div>
</div>
<p>Three cells are defined: first for outer void, second as the intersection of the inner part of box and outer part of sphere, third as the inner part of sphere. Note that for some other cases for particle transport one more void (or with air material) cell should be defined, which contains all objects inside. See exported to PHITS sections below.</p>
<div class="toggle-header docutils container">
<p><strong>Exported from FitsGeo PHITS sections</strong></p>
</div>
<div class="toggle-content docutils container">
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[ Material ]
    mat[1] H 2.0 O 1.0  GAS=0 $ name: &#39;MAT_WATER&#39;
    mat[2] H 2.0 O 1.0  GAS=0 $ name: &#39;MAT_WATER&#39;

[ Mat Name Color ]
        mat     name    size    color
        1       {MAT\_WATER}    1.00    blue
        2       {MAT\_WATER}    1.00    yellow

[ Surface ]
    1   BOX  0.0 0.0 0.0  1.0 0.0 0.0  0.0 1.0 0.0  0.0 0.0 1.0 $ name: &#39;BOX&#39; (box, all angles are 90deg) [x0 y0 z0] [Ax Ay Az] [Bx By Bz] [Cx Cy Cz]
    2   SPH  0.0 0.0 0.0  1.0 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R

[ Cell ]
    100 -1  (1 2) $ name: &#39;Outer Void&#39;

    101 1  1.0  (-1 2)   $ name: &#39;Intersection&#39;
    102 2  1.0  (-2)   $ name: &#39;Inner Sphere&#39;
</pre></div>
</div>
</div></blockquote>
</div>
<div class="toggle-header docutils container">
<p><strong>Full PHITS input file</strong></p>
</div>
<div class="toggle-content docutils container">
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[ Parameters ]
    icntl = 11      # (D=0) 3:ECH 5:ALL VOID 6:SRC 7,8:GSH 11:DSH 12:DUMP

[ Source ]
    s-type = 2      # mono-energetic rectangular source
    e0 = 1          # energy of beam [MeV]
    proj = proton   # kind of incident particle

[ Material ]
    mat[1] H 2.0 O 1.0  GAS=0 $ name: &#39;MAT_WATER&#39;
    mat[2] H 2.0 O 1.0  GAS=0 $ name: &#39;MAT_WATER&#39;

[ Mat Name Color ]
        mat     name    size    color
        1       {MAT\_WATER}    1.00    blue
        2       {MAT\_WATER}    1.00    yellow

[ Surface ]
    1   BOX  0.0 0.0 0.0  1.0 0.0 0.0  0.0 1.0 0.0  0.0 0.0 1.0 $ name: &#39;BOX&#39; (box, all angles are 90deg) [x0 y0 z0] [Ax Ay Az] [Bx By Bz] [Cx Cy Cz]
    2   SPH  0.0 0.0 0.0  1.0 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R

[ Cell ]
    100 -1  (1 2) $ name: &#39;Outer Void&#39;

    101 1  1.0  (-1 2)   $ name: &#39;Intersection&#39;
    102 2  1.0  (-2)   $ name: &#39;Inner Sphere&#39;

[ T-3Dshow ]
    title = Geometry 3D
    x0 = 0
    y0 = 0
    z0 = 0

    w-wdt = 3
    w-hgt = 3
    w-dst = 10

    w-mnw = 400         # Number of meshes in horizontal direction.
    w-mnh = 400         # Number of meshes in vertical direction.
    w-ang = 0

    e-the = -45
    e-phi = 24
    e-dst = 100

    l-the = 80
    l-phi = 140
    l-dst = 200*100

    file = example_3D
    output = 3          # (D=3) Region boundary + color
    width = 0.5         # (D=0.5) The option defines the line thickness.
    epsout = 1

[ E n d ]
</pre></div>
</div>
</div></blockquote>
</div>
<div class="align-center figure" id="id16">
<img alt="{{ base_path }}/fitsgeo/_images/cell_example.png" src="{{ base_path }}/fitsgeo/_images/cell_example.png" />
<p class="caption"><span class="caption-text"><strong>Another cells definition (ANGEL visualization)</strong></span><a class="headerlink" href="#id16" title="Permalink to this image">¶</a></p>
</div>
<p>Finally, just like <code class="docutils literal notranslate"><span class="pre">surface</span></code> and <code class="docutils literal notranslate"><span class="pre">material</span></code> modules, <code class="docutils literal notranslate"><span class="pre">cell</span></code> module provides <code class="docutils literal notranslate"><span class="pre">created_cells</span></code> — list with all initialized cells in it.</p>
<p>To get this list:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fitsgeo</span><span class="o">.</span><span class="n">created_cells</span>
</pre></div>
</div>
</div>
<div class="section" id="id6">
<h3>Export module<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>Module provides functions for export of all defined objects to MC code understandable format (only export to PHTIS for now). Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fitsgeo</span><span class="o">.</span><span class="n">phits_export</span><span class="p">()</span>
</pre></div>
</div>
<p>This will print [ Surface ], [ Cell ] and [ Material ] sections in console (other sections may be exported in future releases). By default all sections are exported in console, but this behaviour may be configured by providing additional parameters:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">to_file:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></code> — flag to export sections to the input file (flag <code class="docutils literal notranslate"><span class="pre">False</span></code> by default — only export to console)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inp_name:</span> <span class="pre">str</span> <span class="pre">=</span> <span class="pre">&quot;example&quot;</span></code> — name for input file export</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">export_surfaces:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></code> — flag for [ Surface ] section export</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">export_materials:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></code> — flag for [ Material ] section export</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">export_cells:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></code> — flag for [ Cell ] section export</p></li>
</ul>
<p>Example of exporting sections to input file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fitsgeo</span><span class="o">.</span><span class="n">phits_export</span><span class="p">(</span><span class="n">to_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inp_name</span><span class="o">=</span><span class="s2">&quot;example&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This will export all defined sections in one <code class="docutils literal notranslate"><span class="pre">example_FitsGeo.inp</span></code> file. Some sections may be excluded from export:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fitsgeo</span><span class="o">.</span><span class="n">phits_export</span><span class="p">(</span><span class="n">to_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inp_name</span><span class="o">=</span><span class="s2">&quot;example&quot;</span><span class="p">,</span> <span class="n">export_materials</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>This will export only [ Surface ] and [ Cell ] sections.</p>
<p>If some of sections not defined (some of lists with objects are empty) these sections will be skiped and warning notification in console appears. For example, if there are no cells defined notification in console will be:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>No cell is defined!
created_cells list is empty!
</pre></div>
</div>
<p>Same for other objects.</p>
</div>
</div>
<div class="section" id="example-0-the-column">
<h2>Example 0: The Column<a class="headerlink" href="#example-0-the-column" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Illustrative example of FitsGeo usage. Very basic example of how to use FitsGeo</p>
<div class="align-center figure" id="id17">
<img alt="{{ base_path }}/fitsgeo/_images/example0_fg.png" src="{{ base_path }}/fitsgeo/_images/example0_fg.png" />
<p class="caption"><span class="caption-text"><strong>Example 0: FitsGeo visualization</strong></span><a class="headerlink" href="#id17" title="Permalink to this image">¶</a></p>
</div>
<div class="toggle-header docutils container">
<p><strong>Example 0: full FitsGeo code</strong></p>
</div>
<div class="toggle-content docutils container">
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Example 0: The Column</span>
<span class="c1"># Very basic example of how to use FitsGeo</span>
<span class="kn">import</span> <span class="nn">fitsgeo</span> <span class="k">as</span> <span class="nn">fg</span>  <span class="c1"># Alias to make it shorter</span>

<span class="c1"># Define materials from predefined databases</span>
<span class="n">concrete</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_CONCRETE&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">bronze</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_BRONZE&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;pastelbrown&quot;</span><span class="p">)</span>

<span class="n">fg</span><span class="o">.</span><span class="n">create_scene</span><span class="p">(</span><span class="n">ax_length</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># Create scene with default settings</span>

<span class="n">base</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">RCC</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Base&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">concrete</span><span class="p">)</span>
<span class="n">cone</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">TRC</span><span class="p">(</span>
	<span class="n">base</span><span class="o">.</span><span class="n">h</span><span class="p">,</span>
	<span class="p">[</span><span class="n">base</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">base</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">base</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span><span class="p">],</span>
	<span class="n">r_1</span><span class="o">=</span><span class="n">base</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">r_2</span><span class="o">=</span><span class="n">base</span><span class="o">.</span><span class="n">r</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Cone&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">concrete</span><span class="p">)</span>
<span class="n">platform</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">RPP</span><span class="p">(</span>
	<span class="p">[</span><span class="o">-</span><span class="n">cone</span><span class="o">.</span><span class="n">r_2</span><span class="p">,</span> <span class="n">cone</span><span class="o">.</span><span class="n">r_2</span><span class="p">],</span>
	<span class="p">[</span><span class="n">cone</span><span class="o">.</span><span class="n">y0</span><span class="o">+</span><span class="n">cone</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cone</span><span class="o">.</span><span class="n">y0</span><span class="o">+</span><span class="n">cone</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">cone</span><span class="o">.</span><span class="n">get_len_h</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span>
	<span class="p">[</span><span class="o">-</span><span class="n">cone</span><span class="o">.</span><span class="n">r_2</span><span class="p">,</span> <span class="n">cone</span><span class="o">.</span><span class="n">r_2</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Platform&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">concrete</span><span class="p">)</span>
<span class="n">ball</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">SPH</span><span class="p">(</span>
	<span class="p">[</span><span class="n">platform</span><span class="o">.</span><span class="n">get_center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
	 <span class="n">platform</span><span class="o">.</span><span class="n">get_center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">cone</span><span class="o">.</span><span class="n">r_2</span><span class="o">/</span><span class="mf">1.4</span><span class="o">+</span><span class="n">platform</span><span class="o">.</span><span class="n">get_height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
	 <span class="n">platform</span><span class="o">.</span><span class="n">get_center</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">r</span><span class="o">=</span><span class="n">cone</span><span class="o">.</span><span class="n">r_2</span><span class="o">/</span><span class="mf">1.4</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">bronze</span><span class="p">)</span>

<span class="n">outer_c</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span>
	<span class="p">[</span><span class="o">+</span><span class="n">base</span> <span class="o">+</span> <span class="o">+</span><span class="n">cone</span> <span class="o">+</span> <span class="o">+</span><span class="n">platform</span> <span class="o">+</span> <span class="o">+</span><span class="n">ball</span><span class="p">],</span> <span class="s2">&quot;Outer Void&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">.</span><span class="n">MAT_OUTER</span><span class="p">)</span>
<span class="n">base_c</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">-</span><span class="n">base</span><span class="p">],</span> <span class="s2">&quot;Base Cell&quot;</span><span class="p">,</span> <span class="n">base</span><span class="o">.</span><span class="n">material</span><span class="p">,</span> <span class="n">base</span><span class="o">.</span><span class="n">get_volume</span><span class="p">)</span>
<span class="n">cone_c</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">-</span><span class="n">cone</span><span class="p">],</span> <span class="s2">&quot;Cone Cell&quot;</span><span class="p">,</span> <span class="n">cone</span><span class="o">.</span><span class="n">material</span><span class="p">,</span> <span class="n">cone</span><span class="o">.</span><span class="n">get_volume</span><span class="p">)</span>
<span class="n">platform_c</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span>
	<span class="p">[</span><span class="o">-</span><span class="n">platform</span><span class="p">],</span> <span class="s2">&quot;Platform Cell&quot;</span><span class="p">,</span> <span class="n">platform</span><span class="o">.</span><span class="n">material</span><span class="p">,</span> <span class="n">platform</span><span class="o">.</span><span class="n">get_volume</span><span class="p">)</span>
<span class="n">ball_c</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">-</span><span class="n">ball</span><span class="p">],</span> <span class="s2">&quot;Ball Cell&quot;</span><span class="p">,</span> <span class="n">ball</span><span class="o">.</span><span class="n">material</span><span class="p">,</span> <span class="n">ball</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>

<span class="c1"># Draw all surfaces with labels on centers</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">fg</span><span class="o">.</span><span class="n">created_surfaces</span><span class="p">:</span>
	<span class="n">s</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">label_center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Export to PHITS</span>
<span class="n">fg</span><span class="o">.</span><span class="n">phits_export</span><span class="p">(</span><span class="n">to_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inp_name</span><span class="o">=</span><span class="s2">&quot;example0&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<p>In this example we will create the column as it shown on the picture above. The full FitsGeo code for this example is also shown above.</p>
<p>In the begining we need to import FitsGeo:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>3</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fitsgeo</span> <span class="k">as</span> <span class="nn">fg</span>  <span class="c1"># Alias to make it shorter</span>
</pre></div>
</td></tr></table></div>
<p>Here we import FitsGeo with <code class="docutils literal notranslate"><span class="pre">fg</span></code> alias to make it shorter. Thus, to get the FitsGeo functionality we will use <code class="docutils literal notranslate"><span class="pre">fg</span></code>, not <code class="docutils literal notranslate"><span class="pre">fitsgeo</span></code>.</p>
<p>First stage of geometry setup is to understand which materials we will need. In this example we only need 2 materials, which can be easily obtained through the predefined databases:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Define materials from predefined databases</span>
<span class="n">concrete</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_CONCRETE&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">bronze</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_BRONZE&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;pastelbrown&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>This is concrete for column base and bronze for sphere on top. The main workflow can be as follows: find the desired materials in the <a class="reference external" href="material.html">Predefined Materials</a> section, see if all properties in the database are ok, and define this material, if something is not as you expect, define this material manually, or change some property (e.g. density) in predefined material just after initialization.</p>
<p>After that we can create default scene as:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>9</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">fg</span><span class="o">.</span><span class="n">create_scene</span><span class="p">(</span><span class="n">ax_length</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># Create scene with default settings</span>
</pre></div>
</td></tr></table></div>
<p>Here we make the axes longer than the ones by default. This line of code can be anywhere, except after lines with the draw method of surfaces. Also, we can just skip this line and not define the scene at all, but in this case we will not be able to change some of the scene properties, and the automatically created scene will have a black background and no axes.</p>
<p>Next part of code defines surfaces for geometry: cylinder, truncated cone and platform for base of column and sphere on top of that:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">base</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">RCC</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Base&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">concrete</span><span class="p">)</span>
<span class="n">cone</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">TRC</span><span class="p">(</span>
	<span class="n">base</span><span class="o">.</span><span class="n">h</span><span class="p">,</span>
	<span class="p">[</span><span class="n">base</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">base</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">base</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="mi">4</span><span class="p">],</span>
	<span class="n">r_1</span><span class="o">=</span><span class="n">base</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">r_2</span><span class="o">=</span><span class="n">base</span><span class="o">.</span><span class="n">r</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Cone&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">concrete</span><span class="p">)</span>
<span class="n">platform</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">RPP</span><span class="p">(</span>
	<span class="p">[</span><span class="o">-</span><span class="n">cone</span><span class="o">.</span><span class="n">r_2</span><span class="p">,</span> <span class="n">cone</span><span class="o">.</span><span class="n">r_2</span><span class="p">],</span>
	<span class="p">[</span><span class="n">cone</span><span class="o">.</span><span class="n">y0</span><span class="o">+</span><span class="n">cone</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cone</span><span class="o">.</span><span class="n">y0</span><span class="o">+</span><span class="n">cone</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">cone</span><span class="o">.</span><span class="n">get_len_h</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span>
	<span class="p">[</span><span class="o">-</span><span class="n">cone</span><span class="o">.</span><span class="n">r_2</span><span class="p">,</span> <span class="n">cone</span><span class="o">.</span><span class="n">r_2</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Platform&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">concrete</span><span class="p">)</span>
<span class="n">ball</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">SPH</span><span class="p">(</span>
	<span class="p">[</span><span class="n">platform</span><span class="o">.</span><span class="n">get_center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
	 <span class="n">platform</span><span class="o">.</span><span class="n">get_center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">cone</span><span class="o">.</span><span class="n">r_2</span><span class="o">/</span><span class="mf">1.4</span><span class="o">+</span><span class="n">platform</span><span class="o">.</span><span class="n">get_height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
	 <span class="n">platform</span><span class="o">.</span><span class="n">get_center</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span> <span class="n">r</span><span class="o">=</span><span class="n">cone</span><span class="o">.</span><span class="n">r_2</span><span class="o">/</span><span class="mf">1.4</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">bronze</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Here, the advantage of FitsGeo use getting more clear: we don’t need to operate with absolute values of every surface. We can just define our “base” surface and place every other surface relatively from it (or from any other surface). Only the <code class="docutils literal notranslate"><span class="pre">base</span></code> has absolute values in parameters, the other surfaces are placed and sized relative to other surfaces. For example: base point of <code class="docutils literal notranslate"><span class="pre">cone</span></code> set as <code class="docutils literal notranslate"><span class="pre">base</span></code> height vector coordinates, base radius of <code class="docutils literal notranslate"><span class="pre">cone</span></code> set as radius of <code class="docutils literal notranslate"><span class="pre">base</span></code> and so on. In this case, if we change any parameter of <code class="docutils literal notranslate"><span class="pre">base</span></code> other surfaces changes accordingly.</p>
<p>After surfaces are defined, we need to define cells:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>25
26
27
28
29
30
31</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">outer_c</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span>
	<span class="p">[</span><span class="o">+</span><span class="n">base</span> <span class="o">+</span> <span class="o">+</span><span class="n">cone</span> <span class="o">+</span> <span class="o">+</span><span class="n">platform</span> <span class="o">+</span> <span class="o">+</span><span class="n">ball</span><span class="p">],</span> <span class="s2">&quot;Outer Void&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">.</span><span class="n">MAT_OUTER</span><span class="p">)</span>
<span class="n">base_c</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">-</span><span class="n">base</span><span class="p">],</span> <span class="s2">&quot;Base Cell&quot;</span><span class="p">,</span> <span class="n">base</span><span class="o">.</span><span class="n">material</span><span class="p">,</span> <span class="n">base</span><span class="o">.</span><span class="n">get_volume</span><span class="p">)</span>
<span class="n">cone_c</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">-</span><span class="n">cone</span><span class="p">],</span> <span class="s2">&quot;Cone Cell&quot;</span><span class="p">,</span> <span class="n">cone</span><span class="o">.</span><span class="n">material</span><span class="p">,</span> <span class="n">cone</span><span class="o">.</span><span class="n">get_volume</span><span class="p">)</span>
<span class="n">platform_c</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span>
	<span class="p">[</span><span class="o">-</span><span class="n">platform</span><span class="p">],</span> <span class="s2">&quot;Platform Cell&quot;</span><span class="p">,</span> <span class="n">platform</span><span class="o">.</span><span class="n">material</span><span class="p">,</span> <span class="n">platform</span><span class="o">.</span><span class="n">get_volume</span><span class="p">)</span>
<span class="n">ball_c</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">-</span><span class="n">ball</span><span class="p">],</span> <span class="s2">&quot;Ball Cell&quot;</span><span class="p">,</span> <span class="n">ball</span><span class="o">.</span><span class="n">material</span><span class="p">,</span> <span class="n">ball</span><span class="o">.</span><span class="n">volume</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Here, the advantage is that we operate with names of surfaces, not with surface numbers. This make it more easy to define cells. Also, we can provide volume of cells automatically, without calculation by hand.</p>
<p>Finally, we can draw surfaces and export all objects to PHITS:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>33
34
35
36
37
38</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Draw all surfaces with labels on centers</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">fg</span><span class="o">.</span><span class="n">created_surfaces</span><span class="p">:</span>
	<span class="n">s</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">label_center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Export to PHITS</span>
<span class="n">fg</span><span class="o">.</span><span class="n">phits_export</span><span class="p">(</span><span class="n">to_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inp_name</span><span class="o">=</span><span class="s2">&quot;example0&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Here, for every surface object there are labels pointing on centers. VPython visualization allows to look on geometry from every side interactively.</p>
<p>The following figure shows the visualization of the geometry in PHITS (via ANGEL). The full input file for PHITS is also shown below, note that the sections exported from FitsGeo are located under lines <strong>14–37</strong>.</p>
<div class="align-center figure" id="id18">
<img alt="{{ base_path }}/fitsgeo/_images/example0_3D.png" src="{{ base_path }}/fitsgeo/_images/example0_3D.png" />
<p class="caption"><span class="caption-text"><strong>Example 0: PHITS visualization</strong></span><a class="headerlink" href="#id18" title="Permalink to this image">¶</a></p>
</div>
<div class="toggle-header docutils container">
<p><strong>Example 0: PHITS input</strong></p>
</div>
<div class="toggle-content docutils container">
<div class="highlight-none notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67</pre></div></td><td class="code"><div class="highlight"><pre><span></span>[ Title ]
	Example 0: The Column
	Illustrative example of FitsGeo usage
	Very basic example of how to use FitsGeo

[ Parameters ]
	icntl = 11		# (D=0) 3:ECH 5:ALL VOID 6:SRC 7,8:GSH 11:DSH 12:DUMP

[ Source ]
	s-type = 2		# mono-energetic rectangular source
	e0 = 1			# energy of beam [MeV]
	proj = proton	# kind of incident particle

<span class="hll">[ Material ]
</span><span class="hll">    mat[1] H 2.0 O 1.0  GAS=0 $ name: &#39;MAT_WATER&#39;
</span><span class="hll">    mat[2] C 23.0 O 40.0 Si 12.0 Ca 12.0 H 10.0 Mg 2.0  GAS=0 $ name: &#39;MAT_CONCRETE&#39;
</span><span class="hll">    mat[3] Cu 89.0 Zn 9.0 Pb 2.0  GAS=0 $ name: &#39;MAT_BRONZE&#39;
</span><span class="hll">
</span><span class="hll">[ Mat Name Color ]
</span><span class="hll">        mat     name    size    color
</span><span class="hll">        1       {MAT\_WATER}    1.00    blue
</span><span class="hll">        2       {MAT\_CONCRETE} 1.00    gray
</span><span class="hll">        3       {MAT\_BRONZE}   1.00    pastelbrown
</span><span class="hll">
</span><span class="hll">[ Surface ]
</span><span class="hll">    1   RCC  0 0 0  0 2 0  0.5 $ name: &#39;Base&#39; (cylinder) [x0 y0 z0] [Hx Hy Hz] R
</span><span class="hll">    2   TRC  0 2 0  0.0 0.5 0.0  0.5  1.0 $ name: &#39;Cone&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    3   RPP  -1.0 1.0  2.5 2.75  -1.0 1.0 $ name: &#39;Platform&#39; (Rectangular solid) [x_min x_max] [y_min y_max] [z_min z_max]
</span><span class="hll">    4   SPH  0.0 3.4642857142857144 0.0  0.7142857142857143 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">
</span><span class="hll">[ Cell ]
</span><span class="hll">    100 -1  (1 2 3 4) $ name: &#39;Outer Void&#39; 
</span><span class="hll">
</span><span class="hll">    101 2  2.34  (-1)  VOL=1.5707963267948966 $ name: &#39;Base Cell&#39; 
</span><span class="hll">    102 2  2.34  (-2)  VOL=0.916297857297023 $ name: &#39;Cone Cell&#39; 
</span><span class="hll">    103 2  2.34  (-3)  VOL=1.0 $ name: &#39;Platform Cell&#39; 
</span><span class="hll">    104 3  8.82  (-4)  VOL=1.526527042560638 $ name: &#39;Ball Cell&#39; 
</span>
[ T-3Dshow ]
	title = Geometry 3D
	x0 = 0
	y0 = 2
	z0 = 0

	w-wdt = 5
	w-hgt = 5
	w-dst = 4

	w-mnw = 400			# Number of meshes in horizontal direction.
	w-mnh = 400			# Number of meshes in vertical direction.
	w-ang = 0

	e-the = 30
	e-phi = 20
	e-dst = 10

	l-the = 80
	l-phi = 140
	l-dst = 200*100

	file = example0_3D
	output = 3			# (D=3) Region boundary + color
	width = 0.5			# (D=0.5) The option defines the line thickness.

	epsout = 1

[ E n d ]
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="example-1-general-illustrative-example-of-fitsgeo">
<h2>Example 1: general illustrative example of FitsGeo<a class="headerlink" href="#example-1-general-illustrative-example-of-fitsgeo" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Illustrative example of FitsGeo usage. Covers all implemented surfaces and features</p>
<div class="align-center figure" id="id19">
<img alt="{{ base_path }}/fitsgeo/_images/example1_fitsgeo.png" src="{{ base_path }}/fitsgeo/_images/example1_fitsgeo.png" />
<p class="caption"><span class="caption-text"><strong>Example 1: FitsGeo visualization</strong></span><a class="headerlink" href="#id19" title="Permalink to this image">¶</a></p>
</div>
<p>In this example, we can see almost all the implemented features and aspects of work with FitsGeo. The full view on created geometry is shown in the image above. The full FitsGeo code for this example is shown below.</p>
<div class="toggle-header docutils container">
<p><strong>Example 1: full FitsGeo code</strong></p>
</div>
<div class="toggle-content docutils container">
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Example 1: general illustrative example of FitsGeo</span>
<span class="c1"># Illustrative example of FitsGeo usage</span>
<span class="c1"># Covers all implemented surfaces and features</span>
<span class="kn">import</span> <span class="nn">fitsgeo</span> <span class="k">as</span> <span class="nn">fg</span>

<span class="n">fg</span><span class="o">.</span><span class="n">list_all_surfaces</span><span class="p">()</span>  <span class="c1"># Shows all implemented surfaces</span>

<span class="c1"># Create main scene with axes</span>
<span class="n">ax_l</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Specify axes length</span>
<span class="n">scene</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">create_scene</span><span class="p">(</span><span class="n">ax_length</span><span class="o">=</span><span class="n">ax_l</span><span class="p">)</span>
<span class="c1"># Change scene background</span>
<span class="n">scene</span><span class="o">.</span><span class="n">background</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">192</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">192</span><span class="p">)</span>

<span class="c1"># Define materials from predefined databases</span>
<span class="n">epoxy</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_EPOXY&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;pastelblue&quot;</span><span class="p">)</span>
<span class="n">glass</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_GLASS_PB&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">al</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_AL&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;brown&quot;</span><span class="p">)</span>
<span class="n">carbon</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_CARBON&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;purple&quot;</span><span class="p">)</span>
<span class="n">beryllium</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_BE&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>

<span class="c1"># Define material manually</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="p">(</span>
	<span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span> <span class="n">density</span><span class="o">=</span><span class="mf">0.94</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Polyethylene&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;yellow&quot;</span><span class="p">)</span>

<span class="c1"># Surface definitions</span>
<span class="c1"># Plane definition</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">px1</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">py1</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">pz1</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="s2">&quot;z&quot;</span><span class="p">)</span>

<span class="c1"># BOX definition</span>
<span class="n">box_l</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">BOX</span><span class="p">(</span>
	<span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span>
	<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Box_l&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">epoxy</span><span class="p">)</span>
<span class="n">box_r</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">BOX</span><span class="p">(</span>
	<span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span>
	<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Box_r&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">epoxy</span><span class="p">)</span>

<span class="c1"># RPP definition</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">RPP</span><span class="p">(</span>
	<span class="p">[</span><span class="o">-</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Table&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">al</span><span class="p">)</span>

<span class="c1"># SPH definition</span>
<span class="n">ball</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">SPH</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Ball&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">glass</span><span class="p">)</span>

<span class="c1"># RCC definition</span>
<span class="n">cyl</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">RCC</span><span class="p">(</span>
	<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Cylinder&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">beryllium</span><span class="p">)</span>

<span class="c1"># TRC definition</span>
<span class="n">hat</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">TRC</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Hat&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">poly</span><span class="p">)</span>

<span class="c1"># TX definition</span>
<span class="n">hoop</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">T</span><span class="p">(</span>
	<span class="p">[</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Hoop&quot;</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">carbon</span><span class="p">)</span>

<span class="c1"># TY definition</span>
<span class="n">ring</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">T</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Ring&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">poly</span><span class="p">)</span>

<span class="c1"># TZ definition</span>
<span class="n">donut</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">T</span><span class="p">(</span>
	<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Donut&quot;</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="s2">&quot;z&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">carbon</span><span class="p">)</span>

<span class="c1"># REC definition</span>
<span class="n">tabletop</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">REC</span><span class="p">(</span>
	<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
	<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
	<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
	<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Table Top&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">al</span><span class="p">)</span>

<span class="n">wedge_r</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">WED</span><span class="p">(</span>
	<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wedge R&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">al</span><span class="p">)</span>
<span class="n">wedge_l</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">WED</span><span class="p">(</span>
	<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Wedge L&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">al</span><span class="p">)</span>

<span class="c1"># We need surface which will contain all surfaces</span>
<span class="n">void</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">RCC</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">fg</span><span class="o">.</span><span class="n">MAT_VOID</span><span class="p">)</span>

<span class="c1"># Redefine properties</span>
<span class="n">box_l</span><span class="o">.</span><span class="n">xyz0</span> <span class="o">=</span> <span class="p">[</span><span class="n">box_l</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">box_l</span><span class="o">.</span><span class="n">y0</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">box_l</span><span class="o">.</span><span class="n">z0</span><span class="o">+</span><span class="mf">0.1</span><span class="p">]</span>
<span class="n">box_r</span><span class="o">.</span><span class="n">xyz0</span> <span class="o">=</span> <span class="p">[</span><span class="n">box_r</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">box_r</span><span class="o">.</span><span class="n">y0</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">box_r</span><span class="o">.</span><span class="n">z0</span><span class="o">+</span><span class="mf">0.1</span><span class="p">]</span>
<span class="n">box_r</span><span class="o">.</span><span class="n">z0</span> <span class="o">=</span> <span class="n">box_r</span><span class="o">.</span><span class="n">z0</span><span class="o">+</span><span class="mf">2.8</span>

<span class="n">cyl</span><span class="o">.</span><span class="n">xyz0</span> <span class="o">=</span> <span class="n">box_r</span><span class="o">.</span><span class="n">get_center</span>
<span class="n">cyl</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="n">box_l</span><span class="o">.</span><span class="n">get_center</span> <span class="o">-</span> <span class="n">box_r</span><span class="o">.</span><span class="n">get_center</span>

<span class="n">ring</span><span class="o">.</span><span class="n">xyz0</span> <span class="o">=</span> <span class="p">[</span>
	<span class="n">tabletop</span><span class="o">.</span><span class="n">x0</span> <span class="o">-</span> <span class="n">tabletop</span><span class="o">.</span><span class="n">get_len_b</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span>
	<span class="n">tabletop</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">tabletop</span><span class="o">.</span><span class="n">get_len_h</span> <span class="o">+</span> <span class="n">ring</span><span class="o">.</span><span class="n">b</span><span class="p">,</span>
	<span class="n">tabletop</span><span class="o">.</span><span class="n">z0</span> <span class="o">-</span> <span class="n">tabletop</span><span class="o">.</span><span class="n">get_len_b</span><span class="o">/</span><span class="mi">3</span><span class="p">]</span>

<span class="n">donut</span><span class="o">.</span><span class="n">xyz0</span> <span class="o">=</span> <span class="p">[</span>
	<span class="n">cyl</span><span class="o">.</span><span class="n">get_center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cyl</span><span class="o">.</span><span class="n">get_center</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">cyl</span><span class="o">.</span><span class="n">get_center</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+</span> <span class="n">cyl</span><span class="o">.</span><span class="n">get_len_h</span><span class="o">/</span><span class="mi">4</span><span class="p">]</span>
<span class="n">donut</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">cyl</span><span class="o">.</span><span class="n">r</span> <span class="o">+</span> <span class="n">donut</span><span class="o">.</span><span class="n">b</span>

<span class="n">hoop</span><span class="o">.</span><span class="n">r</span> <span class="o">=</span> <span class="n">hoop</span><span class="o">.</span><span class="n">r</span> <span class="o">*</span> <span class="mf">0.7</span>
<span class="n">hoop</span><span class="o">.</span><span class="n">x0</span> <span class="o">=</span> <span class="o">-</span><span class="n">table</span><span class="o">.</span><span class="n">get_width</span><span class="o">/</span><span class="mi">2</span> <span class="o">-</span> <span class="n">hoop</span><span class="o">.</span><span class="n">b</span>

<span class="n">table</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">tabletop</span><span class="o">.</span><span class="n">get_len_h</span>

<span class="n">wedge_r</span><span class="o">.</span><span class="n">xyz0</span> <span class="o">=</span> <span class="p">[</span>
	<span class="n">table</span><span class="o">.</span><span class="n">get_center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">table</span><span class="o">.</span><span class="n">get_width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
	<span class="n">table</span><span class="o">.</span><span class="n">get_center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">table</span><span class="o">.</span><span class="n">get_height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
	<span class="n">table</span><span class="o">.</span><span class="n">get_center</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">table</span><span class="o">.</span><span class="n">get_length</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>

<span class="n">wedge_r</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">get_width</span>

<span class="n">wedge_l</span><span class="o">.</span><span class="n">xyz0</span> <span class="o">=</span> <span class="p">[</span>
	<span class="n">table</span><span class="o">.</span><span class="n">get_center</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">table</span><span class="o">.</span><span class="n">get_width</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
	<span class="n">table</span><span class="o">.</span><span class="n">get_center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">table</span><span class="o">.</span><span class="n">get_height</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
	<span class="n">table</span><span class="o">.</span><span class="n">get_center</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">table</span><span class="o">.</span><span class="n">get_length</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>

<span class="n">wedge_l</span><span class="o">.</span><span class="n">h</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">table</span><span class="o">.</span><span class="n">get_width</span>
<span class="n">wedge_l</span><span class="o">.</span><span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">wedge_l</span><span class="o">.</span><span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="c1"># Draw objects on scene</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">px1</span><span class="p">,</span> <span class="n">py1</span><span class="p">,</span> <span class="n">pz1</span><span class="p">]:</span>
	<span class="n">p</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">ax_l</span><span class="p">)</span>  <span class="c1"># Plane will be sized according to axes</span>

<span class="c1"># Draw separately if some flags needed</span>
<span class="n">box_l</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">label_base</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label_center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">box_r</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">label_base</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label_center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ball</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">label_center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">hoop</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">label_center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Draw through list without additional flags</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="n">table</span><span class="p">,</span> <span class="n">cyl</span><span class="p">,</span> <span class="n">hat</span><span class="p">,</span> <span class="n">ring</span><span class="p">,</span> <span class="n">donut</span><span class="p">,</span> <span class="n">tabletop</span><span class="p">,</span> <span class="n">wedge_l</span><span class="p">,</span> <span class="n">wedge_r</span><span class="p">,</span> <span class="n">void</span><span class="p">]:</span>
	<span class="n">s</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="c1"># Create cells</span>
<span class="n">outer_c</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">+</span><span class="n">void</span><span class="p">],</span> <span class="s2">&quot;Outer Void&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">.</span><span class="n">MAT_OUTER</span><span class="p">)</span>

<span class="c1"># List of surfaces inside void surface</span>
<span class="n">surfaces</span> <span class="o">=</span> <span class="p">[</span>
	<span class="n">box_l</span><span class="p">,</span> <span class="n">box_r</span><span class="p">,</span>
	<span class="n">table</span><span class="p">,</span> <span class="n">tabletop</span><span class="p">,</span> <span class="n">ball</span><span class="p">,</span> <span class="n">cyl</span><span class="p">,</span> <span class="n">hat</span><span class="p">,</span> <span class="n">hoop</span><span class="p">,</span> <span class="n">ring</span><span class="p">,</span> <span class="n">donut</span><span class="p">,</span> <span class="n">wedge_l</span><span class="p">,</span> <span class="n">wedge_r</span><span class="p">]</span>

<span class="c1"># String with surfaces for cell definition</span>
<span class="n">inner_surfaces</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">surfaces</span><span class="p">:</span>
	<span class="n">inner_surfaces</span> <span class="o">+=</span> <span class="o">+</span><span class="n">s</span>

<span class="n">void_c</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">-</span><span class="n">void</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">inner_surfaces</span><span class="p">],</span> <span class="s2">&quot;Void&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">.</span><span class="n">MAT_VOID</span><span class="p">)</span>

<span class="n">cells</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">surfaces</span><span class="p">:</span>
	<span class="n">cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">-</span><span class="n">s</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> Cell&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">material</span><span class="p">))</span>

<span class="c1"># Redefine specific cells</span>
<span class="n">cells</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cell_def</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">box_l</span> <span class="o">+</span> <span class="o">+</span><span class="n">cyl</span><span class="p">]</span>
<span class="n">cells</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">cell_def</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">box_r</span> <span class="o">+</span> <span class="o">+</span><span class="n">cyl</span><span class="p">]</span>
<span class="n">cells</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">cell_def</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">ball</span> <span class="o">+</span> <span class="o">+</span><span class="n">cyl</span><span class="p">]</span>

<span class="c1"># Print all properties of defined surfaces</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">fg</span><span class="o">.</span><span class="n">created_surfaces</span><span class="p">:</span>
	<span class="n">s</span><span class="o">.</span><span class="n">print_properties</span><span class="p">()</span>
	<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Export sections to PHITS input file</span>
<span class="n">fg</span><span class="o">.</span><span class="n">phits_export</span><span class="p">(</span><span class="n">to_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inp_name</span><span class="o">=</span><span class="s2">&quot;example1&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<p>First of all, we need to import FitsGeo:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fitsgeo</span> <span class="k">as</span> <span class="nn">fg</span>
</pre></div>
</td></tr></table></div>
<p>In line <strong>6</strong>, we call the command to display all implemented surface classes in the console:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">fg</span><span class="o">.</span><span class="n">list_all_surfaces</span><span class="p">()</span>  <span class="c1"># Shows all implemented surfaces</span>
</pre></div>
</td></tr></table></div>
<p>The part of the code below shows how to create and configure the scene:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Create main scene with axes</span>
<span class="n">ax_l</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Specify axes length</span>
<span class="n">scene</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">create_scene</span><span class="p">(</span><span class="n">ax_length</span><span class="o">=</span><span class="n">ax_l</span><span class="p">)</span>
<span class="c1"># Change scene background</span>
<span class="n">scene</span><span class="o">.</span><span class="n">background</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">rgb_to_vector</span><span class="p">(</span><span class="mi">192</span><span class="p">,</span> <span class="mi">192</span><span class="p">,</span> <span class="mi">192</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Here we use special <code class="docutils literal notranslate"><span class="pre">ax_l</span></code> variable for axes length. We can also change background of scene through VPython <code class="docutils literal notranslate"><span class="pre">background</span></code> parameter. This is a VPython color vector. In this case, background defined through <code class="docutils literal notranslate"><span class="pre">rgb_to_vector</span></code> function with RGB colors.</p>
<p>In the lines <strong>14-23</strong> we define materials for future geometry in two ways: from databases and manually for Polyethylene:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Define materials from predefined databases</span>
<span class="n">epoxy</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_EPOXY&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;pastelblue&quot;</span><span class="p">)</span>
<span class="n">glass</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_GLASS_PB&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">al</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_AL&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;brown&quot;</span><span class="p">)</span>
<span class="n">carbon</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_CARBON&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;purple&quot;</span><span class="p">)</span>
<span class="n">beryllium</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_BE&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>

<span class="c1"># Define material manually</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="p">(</span>
	<span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span> <span class="n">density</span><span class="o">=</span><span class="mf">0.94</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Polyethylene&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;yellow&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Starting from line <strong>25</strong> we define surfaces. Following part of code defines planes:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>26
27
28
29
30</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Plane definition</span>
<span class="n">p1</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">px1</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">py1</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">pz1</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">P</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">vert</span><span class="o">=</span><span class="s2">&quot;z&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">p1</span></code> is a general plane: a plane that is not vertical with any axis. <code class="docutils literal notranslate"><span class="pre">px1</span></code>, <code class="docutils literal notranslate"><span class="pre">py1</span></code>, <code class="docutils literal notranslate"><span class="pre">pz1</span></code> — special cases of planes vertical with <span class="math notranslate nohighlight">\(X\)</span>, <span class="math notranslate nohighlight">\(Y\)</span> and <span class="math notranslate nohighlight">\(Z\)</span> axis accordingly. If we provide <code class="docutils literal notranslate"><span class="pre">vert</span></code> parameter with vertical axis, only <code class="docutils literal notranslate"><span class="pre">d</span></code> parameter for plane equation has meaning, and other parameters in plane equation can be any. We can also define these special cases only using the general plane, not providing <code class="docutils literal notranslate"><span class="pre">vert</span></code>. In this example we need planes only for demonstration of feature and we don’t use them for cells definitions, but, as any other surface, plane can be used for cells definitions as well. Also, unlike to other surfaces, we don’t need to pass materials to planes, colors are set depending on vertical axis and for general plane it is a mix of colors.</p>
<p>In the lines <strong>32–75</strong> we define surfaces from every class of <code class="docutils literal notranslate"><span class="pre">surface</span></code> module of FitsGeo. Every surface has common with other surfaces parameters and specific ones. After that, one more <code class="docutils literal notranslate"><span class="pre">void</span></code> surface is defined:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>77
78</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># We need surface which will contain all surfaces</span>
<span class="n">void</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">RCC</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">fg</span><span class="o">.</span><span class="n">MAT_VOID</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>We need this surface to contain all our surfaces inside. Later we will assign cell with it (this can be filled with vacuum or air material).</p>
<p>All defined parameters of surfaces can be changed later as shown in lines <strong>80–115</strong>. These lines demonstrate how we can easily define new positions or sizes for our objects relative to other objects. This is the advantage of OOP way of geometry creation.</p>
<p>After that, we can draw all surfaces. We can use different approaches for that. Next part of code shows how to draw planes:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>117
118
119</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Draw objects on scene</span>
<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="n">p1</span><span class="p">,</span> <span class="n">px1</span><span class="p">,</span> <span class="n">py1</span><span class="p">,</span> <span class="n">pz1</span><span class="p">]:</span>
	<span class="n">p</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">ax_l</span><span class="p">)</span>  <span class="c1"># Plane will be sized according to axes</span>
</pre></div>
</td></tr></table></div>
<p>Since the plane has infinite dimensions, we need to pass a special <code class="docutils literal notranslate"><span class="pre">size</span></code> parameter to the <code class="docutils literal notranslate"><span class="pre">draw</span></code> method. This parameter limits plane and allows to draw this plane as square (if plane is vertical) or as parallelogram for general case.</p>
<p>We can draw every surface separately as it shown below:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>121
122
123
124
125</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Draw separately if some flags needed</span>
<span class="n">box_l</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">label_base</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">label_center</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">box_r</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">label_base</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">label_center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">ball</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">label_center</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">hoop</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">label_center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>This is useful if we need to provide some labels to specific surfaces only, or if we need to change opacity levels.</p>
<p>Alternatively, we can define surfaces through for cycle:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>127
128
129</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Draw through list without additional flags</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="n">table</span><span class="p">,</span> <span class="n">cyl</span><span class="p">,</span> <span class="n">hat</span><span class="p">,</span> <span class="n">ring</span><span class="p">,</span> <span class="n">donut</span><span class="p">,</span> <span class="n">tabletop</span><span class="p">,</span> <span class="n">wedge_l</span><span class="p">,</span> <span class="n">wedge_r</span><span class="p">,</span> <span class="n">void</span><span class="p">]:</span>
	<span class="n">s</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>This works if we don’t need to provide specific additional parameters to the <code class="docutils literal notranslate"><span class="pre">draw</span></code> method.</p>
<p>The following image shows another advantage: interactive visualization. We can see even really small parts of created geometry, like the ring on the table. And it is not so easy to obtain using only ANGEL visualization in PHITS, because we will need to change camera settings accordingly.</p>
<div class="align-center figure" id="id20">
<img alt="{{ base_path }}/fitsgeo/_images/example1_fitsgeo_closeshot.png" src="{{ base_path }}/fitsgeo/_images/example1_fitsgeo_closeshot.png" />
<p class="caption"><span class="caption-text"><strong>Example 1: FitsGeo visualization (ring close shot)</strong></span><a class="headerlink" href="#id20" title="Permalink to this image">¶</a></p>
</div>
<p>Starting from line <strong>131</strong>, the part of the code with cell definitions begins. Following code defines “outer void” cell:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>131
132</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Create cells</span>
<span class="n">outer_c</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">+</span><span class="n">void</span><span class="p">],</span> <span class="s2">&quot;Outer Void&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">.</span><span class="n">MAT_OUTER</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>In this cell transport of all particles stops.</p>
<p>The next part is a bit tricky:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>134
135
136
137
138
139
140
141
142
143
144</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># List of surfaces inside void surface</span>
<span class="n">surfaces</span> <span class="o">=</span> <span class="p">[</span>
	<span class="n">box_l</span><span class="p">,</span> <span class="n">box_r</span><span class="p">,</span>
	<span class="n">table</span><span class="p">,</span> <span class="n">tabletop</span><span class="p">,</span> <span class="n">ball</span><span class="p">,</span> <span class="n">cyl</span><span class="p">,</span> <span class="n">hat</span><span class="p">,</span> <span class="n">hoop</span><span class="p">,</span> <span class="n">ring</span><span class="p">,</span> <span class="n">donut</span><span class="p">,</span> <span class="n">wedge_l</span><span class="p">,</span> <span class="n">wedge_r</span><span class="p">]</span>

<span class="c1"># String with surfaces for cell definition</span>
<span class="n">inner_surfaces</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">surfaces</span><span class="p">:</span>
	<span class="n">inner_surfaces</span> <span class="o">+=</span> <span class="o">+</span><span class="n">s</span>

<span class="n">void_c</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">-</span><span class="n">void</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">inner_surfaces</span><span class="p">],</span> <span class="s2">&quot;Void&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">.</span><span class="n">MAT_VOID</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>To define void cell we need to provide string with intersection of all inner surfaces. At first, we define <code class="docutils literal notranslate"><span class="pre">surfaces</span></code> list which contains all inner surfaces. After that, we create empty <code class="docutils literal notranslate"><span class="pre">inner_surfaces</span></code> string and loop through all surfaces in <code class="docutils literal notranslate"><span class="pre">surfaces</span></code> list to fill this string with intersection of all inner surfaces. And after that, in the line <strong>144</strong> we can finally define void cell as intersection of inner part of <code class="docutils literal notranslate"><span class="pre">void</span></code> surface and <code class="docutils literal notranslate"><span class="pre">inner_surfaces</span></code>. This way we getting cell with space in between of surfaces. It is not necessary to fill this cell with vacuum, we can fill it with air, or, whatever we need.</p>
<p>After that, we need to define cells for inner spaces of surfaces:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>146
147
148
149
150
151
152
153</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">cells</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">surfaces</span><span class="p">:</span>
	<span class="n">cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">-</span><span class="n">s</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">s</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> Cell&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">material</span><span class="p">))</span>

<span class="c1"># Redefine specific cells</span>
<span class="n">cells</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cell_def</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">box_l</span> <span class="o">+</span> <span class="o">+</span><span class="n">cyl</span><span class="p">]</span>
<span class="n">cells</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">cell_def</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">box_r</span> <span class="o">+</span> <span class="o">+</span><span class="n">cyl</span><span class="p">]</span>
<span class="n">cells</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">cell_def</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="n">ball</span> <span class="o">+</span> <span class="o">+</span><span class="n">cyl</span><span class="p">]</span>
</pre></div>
</td></tr></table></div>
<p>Here, we can simply define empty <code class="docutils literal notranslate"><span class="pre">cells</span></code> list and append it using for loop through surfaces in list. But, this will not work for some of them: cells with <code class="docutils literal notranslate"><span class="pre">box_l</span></code>, <code class="docutils literal notranslate"><span class="pre">box_l</span></code> and <code class="docutils literal notranslate"><span class="pre">ball</span></code> surfaces must exclude <code class="docutils literal notranslate"><span class="pre">cyl</span></code> surface. Thus, we need to reconfigure cells <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">1</span></code>, <code class="docutils literal notranslate"><span class="pre">4</span></code> in <code class="docutils literal notranslate"><span class="pre">cells</span></code> list. Again, this is really flexible and not a problem.</p>
<p>The part of the code below shows how we can print all properties of surfaces in the console:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>155
156
157
158</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Print all properties of defined surfaces</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">fg</span><span class="o">.</span><span class="n">created_surfaces</span><span class="p">:</span>
	<span class="n">s</span><span class="o">.</span><span class="n">print_properties</span><span class="p">()</span>
	<span class="nb">print</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
<p>We use the <code class="docutils literal notranslate"><span class="pre">created_surfaces</span></code> list for that. Every surface has a <code class="docutils literal notranslate"><span class="pre">print_properties</span></code> method, which prints all properties of surface in the console.</p>
<p>And the final part of code exports all defined sections to PHITS:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>160
161</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Export sections to PHITS input file</span>
<span class="n">fg</span><span class="o">.</span><span class="n">phits_export</span><span class="p">(</span><span class="n">to_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inp_name</span><span class="o">=</span><span class="s2">&quot;example1&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>The full code of the PHITS input file, as well as the PHITS visualization, are shown below. Note that the sections exported from FitsGeo are located on the <strong>14–68</strong> lines.</p>
<div class="align-center figure" id="id21">
<img alt="{{ base_path }}/fitsgeo/_images/example1_3D.png" src="{{ base_path }}/fitsgeo/_images/example1_3D.png" />
<p class="caption"><span class="caption-text"><strong>Example 1: PHITS visualization</strong></span><a class="headerlink" href="#id21" title="Permalink to this image">¶</a></p>
</div>
<div class="toggle-header docutils container">
<p><strong>Example 1: PHITS input</strong></p>
</div>
<div class="toggle-content docutils container">
<div class="highlight-none notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97</pre></div></td><td class="code"><div class="highlight"><pre><span></span>[ Title ]
	Example 1: general illustrative example of FitsGeo
	Illustrative example of FitsGeo usage
	Covers all implemented surfaces and features

[ Parameters ]
	icntl = 11		# (D=0) 3:ECH 5:ALL VOID 6:SRC 7,8:GSH 11:DSH 12:DUMP

[ Source ]
	s-type = 2		# mono-energetic rectangular source
	e0 = 1			# energy of beam [MeV]
	proj = proton	# kind of incident particle

<span class="hll">[ Material ]
</span><span class="hll">    mat[1] H 2.0 O 1.0  GAS=0 $ name: &#39;MAT_WATER&#39;
</span><span class="hll">    mat[2] H 19.0 C 18.0 O 3.0  GAS=0 $ name: &#39;MAT_EPOXY&#39;
</span><span class="hll">    mat[3] O 59.0 Si 24.0 Pb 5.0 Na 7.0 K 4.0  GAS=0 $ name: &#39;MAT_GLASS_PB&#39;
</span><span class="hll">    mat[4] Al 1.0  GAS=0 $ name: &#39;MAT_AL&#39;
</span><span class="hll">    mat[5] C 6.0  GAS=0 $ name: &#39;MAT_CARBON&#39;
</span><span class="hll">    mat[6] Be 1.0  GAS=0 $ name: &#39;MAT_BE&#39;
</span><span class="hll">    mat[7] C 2 H 4  GAS=0 $ name: &#39;Polyethylene&#39;
</span><span class="hll">
</span><span class="hll">[ Mat Name Color ]
</span><span class="hll">        mat     name    size    color
</span><span class="hll">        1       {MAT\_WATER}    1.00    blue
</span><span class="hll">        2       {MAT\_EPOXY}    1.00    pastelblue
</span><span class="hll">        3       {MAT\_GLASS\_PB}        1.00    gray
</span><span class="hll">        4       {MAT\_AL}       1.00    brown
</span><span class="hll">        5       {MAT\_CARBON}   1.00    purple
</span><span class="hll">        6       {MAT\_BE}       1.00    green
</span><span class="hll">        7       {Polyethylene}  1.00    yellow
</span><span class="hll">
</span><span class="hll">[ Surface ]
</span><span class="hll">    1   P  1 -1 -1  4 $ name: &#39;P&#39; (Plane) 1x + -1y + -1z − 4 = 0
</span><span class="hll">    2   PX      1 $ name: &#39;P&#39; (Plane) x = 1
</span><span class="hll">    3   PY      -1 $ name: &#39;P&#39; (Plane) y = -1
</span><span class="hll">    4   PZ      -2 $ name: &#39;P&#39; (Plane) z = -2
</span><span class="hll">    5   BOX  -0.5 1 -1.9  1 0 0  0 1 0  0 0 1 $ name: &#39;Box_l&#39; (box, all angles are 90deg) [x0 y0 z0] [Ax Ay Az] [Bx By Bz] [Cx Cy Cz]
</span><span class="hll">    6   BOX  -0.5 1 0.8999999999999999  1 0 0  0 1 0  0 0 1 $ name: &#39;Box_r&#39; (box, all angles are 90deg) [x0 y0 z0] [Ax Ay Az] [Bx By Bz] [Cx Cy Cz]
</span><span class="hll">    7   RPP  -0.3 0.3  -1 0.9  -0.8 0.8 $ name: &#39;Table&#39; (Rectangular solid) [x_min x_max] [y_min y_max] [z_min z_max]
</span><span class="hll">    8   SPH  0 1.5 0  0.5 $ name: &#39;Ball&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    9   RCC  0.0 1.5 1.4  0.0 0.0 -2.8  0.2 $ name: &#39;Cylinder&#39; (cylinder) [x0 y0 z0] [Hx Hy Hz] R
</span><span class="hll">    10   TRC  0 2 0  0 0.5 0  0.5  0.2 $ name: &#39;Hat&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    11   TX  -0.35 0 0  0.7  0.05  0.08 $ name: &#39;Hoop&#39; (torus, with x rotational axis) [x0 y0 z0] A(R) B C
</span><span class="hll">    12   TY  -0.6666666666666666 1.02 -0.6666666666666666  0.03  0.02  0.01 $ name: &#39;Ring&#39; (torus, with y rotational axis) [x0 y0 z0] A(R) B C
</span><span class="hll">    13   TZ  0.0 1.5 0.7  0.30000000000000004  0.1  0.1 $ name: &#39;Donut&#39; (torus, with z rotational axis) [x0 y0 z0] A(R) B C
</span><span class="hll">    14   REC  0 0.9 0  0 0.1 0  1 0 0  0 2 0 $ name: &#39;Table Top&#39; (elliptical cylinder) [x0 y0 z0] [Hx Hy Hz] [Ax Ay Az] [Bx By Bz]
</span><span class="hll">    15   WED  -0.3 0.8999999999999999 0.8  0 -1 0  0 0 1  0.6 0 0 $ name: &#39;Wedge R&#39; (wedge) [x0 y0 z0] [Ax Ay Az] [Bx By Bz] [Hx Hy Hz]
</span><span class="hll">    16   WED  0.3 0.8999999999999999 -0.8  0 -1 0  0 0 -1  -0.6 0 0 $ name: &#39;Wedge L&#39; (wedge) [x0 y0 z0] [Ax Ay Az] [Bx By Bz] [Hx Hy Hz]
</span><span class="hll">    17   RCC  0 -1.5 0  0 5 0  3 $ name: &#39;RCC&#39; (cylinder) [x0 y0 z0] [Hx Hy Hz] R
</span><span class="hll">
</span><span class="hll">[ Cell ]
</span><span class="hll">    100 -1  (17) $ name: &#39;Outer Void&#39; 
</span><span class="hll">
</span><span class="hll">    101 0  (-17) (5 6 7 14 8 9 10 11 12 13 16 15) $ name: &#39;Void&#39; 
</span><span class="hll">
</span><span class="hll">    102 2  1.18  (-5 9)   $ name: &#39;Box_l Cell&#39; 
</span><span class="hll">    103 2  1.18  (-6 9)   $ name: &#39;Box_r Cell&#39; 
</span><span class="hll">    104 4  2.6989  (-7)   $ name: &#39;Table Cell&#39; 
</span><span class="hll">    105 4  2.6989  (-14)   $ name: &#39;Table Top Cell&#39; 
</span><span class="hll">    106 3  4.8  (-8 9)   $ name: &#39;Ball Cell&#39; 
</span><span class="hll">    107 6  1.848  (-9)   $ name: &#39;Cylinder Cell&#39; 
</span><span class="hll">    108 7  0.94  (-10)   $ name: &#39;Hat Cell&#39; 
</span><span class="hll">    109 5  2.0  (-11)   $ name: &#39;Hoop Cell&#39; 
</span><span class="hll">    110 7  0.94  (-12)   $ name: &#39;Ring Cell&#39; 
</span><span class="hll">    111 5  2.0  (-13)   $ name: &#39;Donut Cell&#39; 
</span><span class="hll">    112 4  2.6989  (-16)   $ name: &#39;Wedge L Cell&#39; 
</span><span class="hll">    113 4  2.6989  (-15)   $ name: &#39;Wedge R Cell&#39; 
</span>
[ T-3Dshow ]
	title = Geometry 3D
	x0 = 0
	y0 = 1
	z0 = 0

	w-wdt = 4
	w-hgt = 4
	w-dst = 10

	w-mnw = 400			# Number of meshes in horizontal direction.
	w-mnh = 400			# Number of meshes in vertical direction.
	w-ang = 0

	e-the = -80
	e-phi = 0
	e-dst = 100

	l-the = 80
	l-phi = 140
	l-dst = 200*100

	file = example1_3D
	output = 3			# (D=3) Region boundary + color
	width = 0.5			# (D=0.5) The option defines the line thickness.
	epsout = 1

[ E n d ]
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="example-2-a-spheres-with-hats">
<h2>Example 2(a): Spheres with Hats<a class="headerlink" href="#example-2-a-spheres-with-hats" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Illustrative example of FitsGeo usage. Shows how to easily create multiple (repeating) objects</p>
<div class="align-center figure" id="id22">
<img alt="{{ base_path }}/fitsgeo/_images/example2a_fitsgeo.png" src="{{ base_path }}/fitsgeo/_images/example2a_fitsgeo.png" />
<p class="caption"><span class="caption-text"><strong>Example 2(a): FitsGeo visualization</strong></span><a class="headerlink" href="#id22" title="Permalink to this image">¶</a></p>
</div>
<p>In this example, the creation of geometry with multiple (repeating) surfaces using FitsGeo is shown. The visualization in FitsGeo of created geometry is shown in the image above. The full FitsGeo code for this example is shown below.</p>
<div class="toggle-header docutils container">
<p><strong>Example 2(a): full FitsGeo code</strong></p>
</div>
<div class="toggle-content docutils container">
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Example 2(a): Spheres with Hats</span>
<span class="c1"># Illustrative example of FitsGeo usage</span>
<span class="c1"># Shows how to easily create multiple (repeating) objects</span>
<span class="kn">import</span> <span class="nn">fitsgeo</span> <span class="k">as</span> <span class="nn">fg</span>

<span class="c1"># Create main scene, with axes</span>
<span class="n">fg</span><span class="o">.</span><span class="n">create_scene</span><span class="p">(</span><span class="n">ax_length</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># Define materials</span>
<span class="n">gold</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_AU&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;yellow&quot;</span><span class="p">)</span>
<span class="n">bronze</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_BRONZE&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;pastelbrown&quot;</span><span class="p">)</span>

<span class="n">spheres</span><span class="p">,</span> <span class="n">hats</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>  <span class="c1"># Lists for surfaces</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># Number of objects along each axis</span>

<span class="n">cells</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List for cells</span>
<span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
	<span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
			<span class="n">s</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">SPH</span><span class="p">(</span>
					<span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">x</span><span class="p">),</span> <span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">y</span><span class="p">),</span> <span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">z</span><span class="p">)],</span>
					<span class="mf">0.5</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">bronze</span><span class="p">)</span>
			<span class="n">spheres</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
			<span class="n">cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">-</span><span class="n">s</span><span class="p">],</span> <span class="sa">f</span><span class="s2">&quot;Cell SPH </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">material</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">volume</span><span class="p">))</span>

			<span class="c1"># Parameters for hat</span>
			<span class="n">hat_h</span> <span class="o">=</span> <span class="n">spheres</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">r</span>
			<span class="n">hat_r</span> <span class="o">=</span> <span class="n">spheres</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">diameter</span> <span class="o">/</span> <span class="mi">2</span>
			<span class="n">hat_x0</span> <span class="o">=</span> <span class="n">spheres</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x0</span>
			<span class="n">hat_y0</span> <span class="o">=</span> <span class="n">spheres</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">hat_h</span>
			<span class="n">hat_z0</span> <span class="o">=</span> <span class="n">spheres</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z0</span>

			<span class="n">s</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">TRC</span><span class="p">(</span>
					<span class="p">[</span><span class="n">hat_x0</span><span class="p">,</span> <span class="n">hat_y0</span><span class="p">,</span> <span class="n">hat_z0</span><span class="p">],</span>
					<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">hat_h</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">hat_r</span><span class="p">,</span> <span class="n">hat_r</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">gold</span><span class="p">)</span>
			<span class="n">hats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
			<span class="n">cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">-</span><span class="n">s</span><span class="p">],</span> <span class="sa">f</span><span class="s2">&quot;Cell TRC </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">material</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">get_volume</span><span class="p">))</span>
			<span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

<span class="c1"># Void definition</span>
<span class="n">inner_surfaces</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">fg</span><span class="o">.</span><span class="n">created_surfaces</span><span class="p">:</span>
	<span class="n">inner_surfaces</span> <span class="o">+=</span> <span class="o">+</span><span class="n">s</span>

<span class="n">void_s</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">RPP</span><span class="p">(</span>
	<span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="s2">&quot;Void Surface&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">fg</span><span class="o">.</span><span class="n">MAT_VOID</span><span class="p">)</span>

<span class="n">outer_c</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span>
	<span class="p">[</span><span class="o">+</span><span class="n">void_s</span><span class="p">],</span> <span class="s2">&quot;Outer Cell&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">.</span><span class="n">MAT_OUTER</span><span class="p">)</span>

<span class="n">void_c</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span>
	<span class="p">[</span><span class="o">-</span><span class="n">void_s</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">inner_surfaces</span><span class="p">],</span> <span class="s2">&quot;Void Cell&quot;</span><span class="p">,</span> <span class="n">void_s</span><span class="o">.</span><span class="n">material</span><span class="p">)</span>

<span class="c1"># Draw surfaces</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">**</span><span class="mi">3</span><span class="p">):</span>
	<span class="n">spheres</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
	<span class="n">hats</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">truncated</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">void_s</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="n">fg</span><span class="o">.</span><span class="n">phits_export</span><span class="p">(</span><span class="n">to_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inp_name</span><span class="o">=</span><span class="s2">&quot;example2a&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<p>Like always, the first thing to do is to import FitsGeo:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fitsgeo</span> <span class="k">as</span> <span class="nn">fg</span>
</pre></div>
</td></tr></table></div>
<p>Create scene with 10 cm of axes length:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Create main scene, with axes</span>
<span class="n">fg</span><span class="o">.</span><span class="n">create_scene</span><span class="p">(</span><span class="n">ax_length</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Define 2 materials from predefined databases with <code class="docutils literal notranslate"><span class="pre">&quot;yellow&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;pastelbrown&quot;</span></code> colors for future spheres and their “hats”:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Define materials</span>
<span class="n">gold</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_AU&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;yellow&quot;</span><span class="p">)</span>
<span class="n">bronze</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_BRONZE&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;pastelbrown&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>After these preparation steps, let’s say we need some structure with repeating parts. In this example, these are spheres and “hats” on top of these spheres. With the help of Python and object-oriented way of geometry development, this will be easy. First, let’s create empty lists for future surfaces and cells and set how many objects we need along each axis:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">spheres</span><span class="p">,</span> <span class="n">hats</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>  <span class="c1"># Lists for surfaces</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>  <span class="c1"># Number of objects along each axis</span>

<span class="n">cells</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List for cells</span>
</pre></div>
</td></tr></table></div>
<p>The next part of code have 3 for loops:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">z</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
	<span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
		<span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
			<span class="n">s</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">SPH</span><span class="p">(</span>
					<span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">x</span><span class="p">),</span> <span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">y</span><span class="p">),</span> <span class="n">z</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">z</span><span class="p">)],</span>
					<span class="mf">0.5</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">bronze</span><span class="p">)</span>
			<span class="n">spheres</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
			<span class="n">cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">-</span><span class="n">s</span><span class="p">],</span> <span class="sa">f</span><span class="s2">&quot;Cell SPH </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">material</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">volume</span><span class="p">))</span>

			<span class="c1"># Parameters for hat</span>
			<span class="n">hat_h</span> <span class="o">=</span> <span class="n">spheres</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">r</span>
			<span class="n">hat_r</span> <span class="o">=</span> <span class="n">spheres</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">diameter</span> <span class="o">/</span> <span class="mi">2</span>
			<span class="n">hat_x0</span> <span class="o">=</span> <span class="n">spheres</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">x0</span>
			<span class="n">hat_y0</span> <span class="o">=</span> <span class="n">spheres</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">hat_h</span>
			<span class="n">hat_z0</span> <span class="o">=</span> <span class="n">spheres</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">z0</span>

			<span class="n">s</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">TRC</span><span class="p">(</span>
					<span class="p">[</span><span class="n">hat_x0</span><span class="p">,</span> <span class="n">hat_y0</span><span class="p">,</span> <span class="n">hat_z0</span><span class="p">],</span>
					<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">hat_h</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">hat_r</span><span class="p">,</span> <span class="n">hat_r</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">gold</span><span class="p">)</span>
			<span class="n">hats</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
			<span class="n">cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">-</span><span class="n">s</span><span class="p">],</span> <span class="sa">f</span><span class="s2">&quot;Cell TRC </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">material</span><span class="p">,</span> <span class="n">s</span><span class="o">.</span><span class="n">get_volume</span><span class="p">))</span>
			<span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</td></tr></table></div>
<p>On each iteration we define one more sphere with hat: surface and cell objects for each of them. Parameters for every new hat are set according to sphere parameters.</p>
<p>The rest part of the code (lines <strong>42–62</strong>) defines last cell objects for void and “outer void”, draws all surfaces and exports sections to PHITS input, just like it was done in the examples discussed previously. Similarly, we can easily create more repeating objects depending on our needs.</p>
<p>Full PHITS input file and visualization of geometry via ANGEL are shown below. The highlighted part of the code — exported sections from FitsGeo.</p>
<div class="toggle-header docutils container">
<p><strong>Example 2(a): PHITS input</strong></p>
</div>
<div class="toggle-content docutils container">
<div class="highlight-none notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169</pre></div></td><td class="code"><div class="highlight"><pre><span></span>[ Title ]
	Example 2(a): Spheres with Hats
	Illustrative example of FitsGeo usage
	Shows how to create multiple (repeating) objects

[ Parameters ]
	icntl = 11		# (D=0) 3:ECH 5:ALL VOID 6:SRC 7,8:GSH 11:DSH 12:DUMP

[ Source ]
	s-type = 2		# mono-energetic rectangular source
	e0 = 1			# energy of beam [MeV]
	proj = proton	# kind of incident particle

<span class="hll">[ Material ]
</span><span class="hll">    mat[1] H 2.0 O 1.0  GAS=0 $ name: &#39;MAT_WATER&#39;
</span><span class="hll">    mat[2] Au 1.0  GAS=0 $ name: &#39;MAT_AU&#39;
</span><span class="hll">    mat[3] Cu 89.0 Zn 9.0 Pb 2.0  GAS=0 $ name: &#39;MAT_BRONZE&#39;
</span><span class="hll">
</span><span class="hll">[ Mat Name Color ]
</span><span class="hll">    mat name    size    color
</span><span class="hll">    1   {MAT\_WATER}    1.00    blue
</span><span class="hll">    2   {MAT\_AU}   1.00    yellow
</span><span class="hll">    3   {MAT\_BRONZE}   1.00    pastelbrown
</span><span class="hll">
</span><span class="hll">[ Surface ]
</span><span class="hll">    1   SPH  0 0 0  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    2   TRC  0 0.5 0  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    3   SPH  2 0 0  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    4   TRC  2 0.5 0  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    5   SPH  4 0 0  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    6   TRC  4 0.5 0  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    7   SPH  0 2 0  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    8   TRC  0 2.5 0  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    9   SPH  2 2 0  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    10   TRC  2 2.5 0  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    11   SPH  4 2 0  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    12   TRC  4 2.5 0  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    13   SPH  0 4 0  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    14   TRC  0 4.5 0  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    15   SPH  2 4 0  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    16   TRC  2 4.5 0  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    17   SPH  4 4 0  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    18   TRC  4 4.5 0  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    19   SPH  0 0 2  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    20   TRC  0 0.5 2  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    21   SPH  2 0 2  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    22   TRC  2 0.5 2  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    23   SPH  4 0 2  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    24   TRC  4 0.5 2  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    25   SPH  0 2 2  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    26   TRC  0 2.5 2  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    27   SPH  2 2 2  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    28   TRC  2 2.5 2  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    29   SPH  4 2 2  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    30   TRC  4 2.5 2  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    31   SPH  0 4 2  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    32   TRC  0 4.5 2  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    33   SPH  2 4 2  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    34   TRC  2 4.5 2  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    35   SPH  4 4 2  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    36   TRC  4 4.5 2  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    37   SPH  0 0 4  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    38   TRC  0 0.5 4  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    39   SPH  2 0 4  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    40   TRC  2 0.5 4  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    41   SPH  4 0 4  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    42   TRC  4 0.5 4  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    43   SPH  0 2 4  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    44   TRC  0 2.5 4  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    45   SPH  2 2 4  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    46   TRC  2 2.5 4  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    47   SPH  4 2 4  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    48   TRC  4 2.5 4  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    49   SPH  0 4 4  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    50   TRC  0 4.5 4  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    51   SPH  2 4 4  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    52   TRC  2 4.5 4  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    53   SPH  4 4 4  0.5 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    54   TRC  4 4.5 4  0 0.5 0  0.5  0.25 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    55   RPP  -1 6  -1 6  -1 6 $ name: &#39;Void Surface&#39; (Rectangular solid) [x_min x_max] [y_min y_max] [z_min z_max]
</span><span class="hll">
</span><span class="hll">[ Cell ]
</span><span class="hll">    100 3  8.82  (-1)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 0&#39; 
</span><span class="hll">    101 2  19.32  (-2)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 0&#39; 
</span><span class="hll">    102 3  8.82  (-3)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 1&#39; 
</span><span class="hll">    103 2  19.32  (-4)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 1&#39; 
</span><span class="hll">    104 3  8.82  (-5)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 2&#39; 
</span><span class="hll">    105 2  19.32  (-6)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 2&#39; 
</span><span class="hll">    106 3  8.82  (-7)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 3&#39; 
</span><span class="hll">    107 2  19.32  (-8)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 3&#39; 
</span><span class="hll">    108 3  8.82  (-9)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 4&#39; 
</span><span class="hll">    109 2  19.32  (-10)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 4&#39; 
</span><span class="hll">    110 3  8.82  (-11)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 5&#39; 
</span><span class="hll">    111 2  19.32  (-12)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 5&#39; 
</span><span class="hll">    112 3  8.82  (-13)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 6&#39; 
</span><span class="hll">    113 2  19.32  (-14)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 6&#39; 
</span><span class="hll">    114 3  8.82  (-15)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 7&#39; 
</span><span class="hll">    115 2  19.32  (-16)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 7&#39; 
</span><span class="hll">    116 3  8.82  (-17)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 8&#39; 
</span><span class="hll">    117 2  19.32  (-18)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 8&#39; 
</span><span class="hll">    118 3  8.82  (-19)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 9&#39; 
</span><span class="hll">    119 2  19.32  (-20)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 9&#39; 
</span><span class="hll">    120 3  8.82  (-21)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 10&#39; 
</span><span class="hll">    121 2  19.32  (-22)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 10&#39; 
</span><span class="hll">    122 3  8.82  (-23)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 11&#39; 
</span><span class="hll">    123 2  19.32  (-24)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 11&#39; 
</span><span class="hll">    124 3  8.82  (-25)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 12&#39; 
</span><span class="hll">    125 2  19.32  (-26)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 12&#39; 
</span><span class="hll">    126 3  8.82  (-27)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 13&#39; 
</span><span class="hll">    127 2  19.32  (-28)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 13&#39; 
</span><span class="hll">    128 3  8.82  (-29)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 14&#39; 
</span><span class="hll">    129 2  19.32  (-30)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 14&#39; 
</span><span class="hll">    130 3  8.82  (-31)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 15&#39; 
</span><span class="hll">    131 2  19.32  (-32)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 15&#39; 
</span><span class="hll">    132 3  8.82  (-33)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 16&#39; 
</span><span class="hll">    133 2  19.32  (-34)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 16&#39; 
</span><span class="hll">    134 3  8.82  (-35)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 17&#39; 
</span><span class="hll">    135 2  19.32  (-36)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 17&#39; 
</span><span class="hll">    136 3  8.82  (-37)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 18&#39; 
</span><span class="hll">    137 2  19.32  (-38)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 18&#39; 
</span><span class="hll">    138 3  8.82  (-39)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 19&#39; 
</span><span class="hll">    139 2  19.32  (-40)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 19&#39; 
</span><span class="hll">    140 3  8.82  (-41)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 20&#39; 
</span><span class="hll">    141 2  19.32  (-42)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 20&#39; 
</span><span class="hll">    142 3  8.82  (-43)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 21&#39; 
</span><span class="hll">    143 2  19.32  (-44)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 21&#39; 
</span><span class="hll">    144 3  8.82  (-45)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 22&#39; 
</span><span class="hll">    145 2  19.32  (-46)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 22&#39; 
</span><span class="hll">    146 3  8.82  (-47)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 23&#39; 
</span><span class="hll">    147 2  19.32  (-48)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 23&#39; 
</span><span class="hll">    148 3  8.82  (-49)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 24&#39; 
</span><span class="hll">    149 2  19.32  (-50)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 24&#39; 
</span><span class="hll">    150 3  8.82  (-51)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 25&#39; 
</span><span class="hll">    151 2  19.32  (-52)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 25&#39; 
</span><span class="hll">    152 3  8.82  (-53)  VOL=0.5235987755982988 $ name: &#39;Cell SPH 26&#39; 
</span><span class="hll">    153 2  19.32  (-54)  VOL=0.22907446432425574 $ name: &#39;Cell TRC 26&#39; 
</span><span class="hll">    154 -1  (55) $ name: &#39;Outer Cell&#39; 
</span><span class="hll">
</span><span class="hll">    155 0  (-55) (1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54) $ name: &#39;Void Cell&#39; 
</span>
[ T-3Dshow ]
	title = Geometry 3D
	x0 = 0
	y0 = 0
	z0 = 0

	w-wdt = 10
	w-hgt = 10
	w-dst = 10

	w-mnw = 400			# Number of meshes in horizontal direction.
	w-mnh = 400			# Number of meshes in vertical direction.
	w-ang = 0

	e-the = 45
	e-phi = 45
	e-dst = 20

	l-the = 80
	l-phi = 140
	l-dst = 200*100

	file = example2a_3D
	output = 3			# (D=3) Region boundary + color
	width = 0.5			# (D=0.5) The option defines the line thickness.

	epsout = 1

[ E n d ]
</pre></div>
</td></tr></table></div>
</div>
<div class="align-center figure" id="id23">
<img alt="{{ base_path }}/fitsgeo/_images/example2a_3D.png" src="{{ base_path }}/fitsgeo/_images/example2a_3D.png" />
<p class="caption"><span class="caption-text"><strong>Example 2(a): PHITS visualization</strong></span><a class="headerlink" href="#id23" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="example-2-b-snake">
<h2>Example 2(b): Snake!<a class="headerlink" href="#example-2-b-snake" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Illustrative example of FitsGeo usage. Shows how to create multiple (repeating) objects according to some math laws</p>
<div class="align-center figure" id="id24">
<img alt="{{ base_path }}/fitsgeo/_images/fitsgeo_snake.png" src="{{ base_path }}/fitsgeo/_images/fitsgeo_snake.png" />
<p class="caption"><span class="caption-text"><strong>Example 2(b): Snake! FitsGeo visualization</strong></span><a class="headerlink" href="#id24" title="Permalink to this image">¶</a></p>
</div>
<p>This example shows how we can define multiple surface objects according to some math laws. The final result of visualization via FitsGeo is in the picture above. The full code of the example is shown below.</p>
<div class="toggle-header docutils container">
<p><strong>Example 2(b): Snake!</strong></p>
</div>
<div class="toggle-content docutils container">
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Example 2b: Snake!</span>
<span class="c1"># Illustrative example of FitsGeo usage</span>
<span class="c1"># Shows how to easily create multiple (repeating) objects with some math laws</span>
<span class="kn">import</span> <span class="nn">fitsgeo</span> <span class="k">as</span> <span class="nn">fg</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">linspace</span>  <span class="c1"># To use math functions</span>

<span class="c1"># Create laws for positions of snakes parts</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>  <span class="c1"># Create 50 evenly spaced x values from 0 to 5</span>
<span class="c1"># Law for z coordinate</span>
<span class="n">z_p</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">x_i</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.4</span> <span class="o">*</span> <span class="n">x_i</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="n">r</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.02</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">x_i</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>  <span class="c1"># Law for radius of spheres</span>

<span class="c1"># Define materials for snake and hat</span>
<span class="n">snake_mat</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_SKIN_ICRP&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="n">hat_mat</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_POLYETHYLENE&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>

<span class="n">snake</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List with all parts of snake</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>  <span class="c1"># Take x values starting from i=16</span>
	<span class="n">snake</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
		<span class="n">fg</span><span class="o">.</span><span class="n">SPH</span><span class="p">(</span><span class="n">xyz0</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">z_p</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">material</span><span class="o">=</span><span class="n">snake_mat</span><span class="p">))</span>

<span class="n">last_part</span> <span class="o">=</span> <span class="n">snake</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">snake</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">hat</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">TRC</span><span class="p">(</span>
	<span class="n">xyz0</span><span class="o">=</span><span class="p">[</span>
		<span class="n">last_part</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span>
		<span class="n">last_part</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">last_part</span><span class="o">.</span><span class="n">r</span><span class="p">,</span>
		<span class="n">last_part</span><span class="o">.</span><span class="n">z0</span><span class="p">],</span>
	<span class="n">h</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_part</span><span class="o">.</span><span class="n">diameter</span><span class="o">/</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
	<span class="n">r_1</span><span class="o">=</span><span class="n">last_part</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="mf">1.5</span><span class="p">,</span>
	<span class="n">r_2</span><span class="o">=</span><span class="mf">1e-9</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">hat_mat</span><span class="p">)</span>

<span class="n">void</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">RCC</span><span class="p">(</span>
	<span class="n">xyz0</span><span class="o">=</span><span class="p">[</span>
		<span class="n">snake</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">x0</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span>
		<span class="n">snake</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span>
		<span class="n">snake</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">z0</span><span class="p">],</span> <span class="n">h</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">r</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">fg</span><span class="o">.</span><span class="n">MAT_VOID</span><span class="p">)</span>

<span class="c1"># Define cells</span>
<span class="n">outer_void</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">+</span><span class="n">void</span><span class="p">],</span> <span class="n">material</span><span class="o">=</span><span class="n">fg</span><span class="o">.</span><span class="n">MAT_OUTER</span><span class="p">)</span>
<span class="n">cells</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">snake</span><span class="p">)):</span>
	<span class="n">cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
		<span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">-</span><span class="n">snake</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;Snake Part </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">snake_mat</span><span class="p">))</span>
<span class="c1"># Add a nice hat on head =)</span>
<span class="n">hat_cell</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">-</span><span class="n">hat</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Hat!&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">hat_mat</span><span class="p">)</span>

<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">snake</span><span class="p">:</span>
	<span class="n">text</span> <span class="o">+=</span> <span class="o">+</span><span class="n">s</span>

<span class="n">void_cell</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span>
	<span class="p">[</span><span class="o">-</span><span class="n">void</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">text</span> <span class="o">+</span> <span class="o">+</span><span class="n">hat</span><span class="p">],</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Vacuum&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">fg</span><span class="o">.</span><span class="n">MAT_VOID</span><span class="p">)</span>

<span class="n">fg</span><span class="o">.</span><span class="n">create_scene</span><span class="p">(</span><span class="n">ax_length</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># Create scene before draw</span>

<span class="c1"># Draw snake</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">snake</span><span class="p">:</span>
	<span class="n">s</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
<span class="n">hat</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">truncated</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Difficulties with truncated cone =(</span>
<span class="n">void</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="n">fg</span><span class="o">.</span><span class="n">phits_export</span><span class="p">(</span><span class="n">to_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inp_name</span><span class="o">=</span><span class="s2">&quot;snake&quot;</span><span class="p">)</span>  <span class="c1"># Export sections</span>
</pre></div>
</td></tr></table></div>
</div>
<p>Just like in the previous examples, we need to import FitsGeo first:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">fitsgeo</span> <span class="k">as</span> <span class="nn">fg</span>
</pre></div>
</td></tr></table></div>
<p>After that, we need to import some additional functions from numpy package:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">exp</span><span class="p">,</span> <span class="n">linspace</span>  <span class="c1"># To use math functions</span>
</pre></div>
</td></tr></table></div>
<p>This gives us some mathematical functions with which we can define mathematical expressions later.</p>
<p>So, let’s say we need to define geometry of snake (why not?). This snake will have some number of body segments — spheres. Also, to make this example a bit more harder (and funnier), let’s say that we want to put a small hat on the snake’s head.</p>
<p>Segments of the snake’s body will be placed and sized according to the defined mathematical laws. Equation for positions of sphere segments on the <span class="math notranslate nohighlight">\(xz\)</span>-plane:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(z(x) = 5\cdot\sin(3x)\cdot0.3\exp(-0.4x)\)</span></p>
</div></blockquote>
<p>And on the <span class="math notranslate nohighlight">\(y\)</span> coordinate it is 0 everywhere (but we can define some law for this coordinate as well). The graph for this equation is in the figure below.</p>
<div class="align-center figure" id="id25">
<img alt="{{ base_path }}/fitsgeo/_images/Graph_pos.png" src="{{ base_path }}/fitsgeo/_images/Graph_pos.png" />
<p class="caption"><span class="caption-text"><strong>Math law for positions of snake’s segments (spheres)</strong></span><a class="headerlink" href="#id25" title="Permalink to this image">¶</a></p>
</div>
<p>The law for radius of spheres:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(r(x) = 0.02\exp(0.2x)\)</span></p>
</div></blockquote>
<p>This law will give us slow exponential (almost linear) increase in the radius of spheres depending on the <span class="math notranslate nohighlight">\(x\)</span> coordinate. The graph for this law is on the figure below.</p>
<div class="align-center figure" id="id26">
<img alt="{{ base_path }}/fitsgeo/_images/Graph_r.png" src="{{ base_path }}/fitsgeo/_images/Graph_r.png" />
<p class="caption"><span class="caption-text"><strong>Math law for radiuses of snake’s segments (spheres)</strong></span><a class="headerlink" href="#id26" title="Permalink to this image">¶</a></p>
</div>
<p>Part of the Python code for math expressions:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 7
 8
 9
10
11</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Create laws for positions of snakes parts</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>  <span class="c1"># Create 50 evenly spaced x values from 0 to 5</span>
<span class="c1"># Law for z coordinate</span>
<span class="n">z_p</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span> <span class="o">*</span> <span class="n">sin</span><span class="p">(</span><span class="mi">3</span> <span class="o">*</span> <span class="n">x_i</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">0.4</span> <span class="o">*</span> <span class="n">x_i</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
<span class="n">r</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.02</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">x_i</span><span class="p">)</span> <span class="k">for</span> <span class="n">x_i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>  <span class="c1"># Law for radius of spheres</span>
</pre></div>
</td></tr></table></div>
<p>Here, we create 50 evenly spaced <span class="math notranslate nohighlight">\(x\)</span> values from 0 to 5. And define laws according to the equations above.</p>
<p>In the lines <strong>13–15</strong> we define materials for snake:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>13
14
15</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Define materials for snake and hat</span>
<span class="n">snake_mat</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_SKIN_ICRP&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="p">)</span>
<span class="n">hat_mat</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_POLYETHYLENE&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>This time let it be ICRP skin for body segments and polyethylene for hat from predefined databases.</p>
<p>Next part of the code will generate sphere segments according to laws for positions and radiuses:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>17
18
19
20</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">snake</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># List with all parts of snake</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)):</span>  <span class="c1"># Take x values starting from i=16</span>
	<span class="n">snake</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
		<span class="n">fg</span><span class="o">.</span><span class="n">SPH</span><span class="p">(</span><span class="n">xyz0</span><span class="o">=</span><span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">z_p</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">material</span><span class="o">=</span><span class="n">snake_mat</span><span class="p">))</span>
</pre></div>
</td></tr></table></div>
<p>Each new iteration appends new part of body with specific position and radius to the <code class="docutils literal notranslate"><span class="pre">snake</span></code> list. Pay attention, that here we use <span class="math notranslate nohighlight">\(x\)</span> values from i=16 and make a shift by 3 by the <span class="math notranslate nohighlight">\(x\)</span> coordinate in case to place our snake almost in the center of coordinates.</p>
<p>In lines <strong>22–30</strong> we create our “hardest” part with placing the hat on top of the snake’s head. This task isn’t actually hard with FitsGeo:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>22
23
24
25
26
27
28
29
30</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">last_part</span> <span class="o">=</span> <span class="n">snake</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">snake</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">hat</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">TRC</span><span class="p">(</span>
	<span class="n">xyz0</span><span class="o">=</span><span class="p">[</span>
		<span class="n">last_part</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span>
		<span class="n">last_part</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">last_part</span><span class="o">.</span><span class="n">r</span><span class="p">,</span>
		<span class="n">last_part</span><span class="o">.</span><span class="n">z0</span><span class="p">],</span>
	<span class="n">h</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">last_part</span><span class="o">.</span><span class="n">diameter</span><span class="o">/</span><span class="mf">1.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
	<span class="n">r_1</span><span class="o">=</span><span class="n">last_part</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="mf">1.5</span><span class="p">,</span>
	<span class="n">r_2</span><span class="o">=</span><span class="mf">1e-9</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">hat_mat</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>All we need is to take the last part of <code class="docutils literal notranslate"><span class="pre">snake</span></code> list — the head of snake (line <strong>22</strong>). After that we can create the cone (hat) with parameters relative to that snake’s head.</p>
<p>Last part of the code is about the same as in the another examples. Here we define <code class="docutils literal notranslate"><span class="pre">void</span></code> surface object, <code class="docutils literal notranslate"><span class="pre">outer_void</span></code> cell object, cells for every part of snake and for the hat. Define scene with <code class="docutils literal notranslate"><span class="pre">5</span></code> axes length, draw all surfaces and export everything to the file.</p>
<p>In the line <strong>59</strong> we use special parameter for hat visualization. In current release visualization of truncated cone might lead to some unstability: sometimes these cones are drawn not as expected with different sizes. To avoid this, we can set <code class="docutils literal notranslate"><span class="pre">truncated</span></code> parameter to <code class="docutils literal notranslate"><span class="pre">False</span></code> state, in that case even if cone is truncated, visualization will be performed as for the not truncated case:</p>
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>59</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="n">hat</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">truncated</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># Difficulties with truncated cone =(</span>
</pre></div>
</td></tr></table></div>
<p>Full PHITS input file and visualization of geometry via ANGEL are shown below. The highlighted part of the code — exported sections from FitsGeo.</p>
<div class="toggle-header docutils container">
<p><strong>Example 2(b): Snake! PHITS input</strong></p>
</div>
<div class="toggle-content docutils container">
<div class="highlight-none notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179</pre></div></td><td class="code"><div class="highlight"><pre><span></span>[ Title ]
    Example2b: Snake!
    Illustrative example of FitsGeo usage
    Shows how to create multiple (repeating) objects with some math laws

[ Parameters ]
	icntl = 11		# (D=0) 3:ECH 5:ALL VOID 6:SRC 7,8:GSH 11:DSH 12:DUMP
    #icntl = 0      # (D=0) 3:ECH 5:ALL VOID 6:SRC 7,8:GSH 11:DSH 12:DUMP
    itall = 1
    istdev = -1     # (D=0) Control parameter for statistical uncertainty calculation type and restart mode.
    negs = 1

    maxcas = 1000    # (D=10) number of particles per one batch
    maxbch = 100000     # (D=10) number of batches

[ Source ]
	s-type = 9		
	proj = proton
    x0 = 2
    y0 = 0
    z0 = 0.132
	e0 = 100.0	         
    r0 = 0.0      
    dir = all            

<span class="hll">[ Material ]
</span><span class="hll">    mat[1] H 2.0 O 1.0  GAS=0 $ name: &#39;MAT_WATER&#39;
</span><span class="hll">    mat[2] H -0.1 C -0.204 N -0.042 O -0.645 Na -0.002 P -0.001 S -0.002 Cl -0.003 K -0.001  GAS=0 $ name: &#39;MAT_SKIN_ICRP&#39;
</span><span class="hll">    mat[3] H 4.0 C 2.0  GAS=0 $ name: &#39;MAT_POLYETHYLENE&#39;
</span><span class="hll">
</span><span class="hll">[ Mat Name Color ]
</span><span class="hll">    mat name    size    color
</span><span class="hll">    1   {MAT\_WATER}    1.00    blue
</span><span class="hll">    2   {MAT\_SKIN\_ICRP}   1.00    green
</span><span class="hll">    3   {MAT\_POLYETHYLENE} 1.00    blue
</span><span class="hll">
</span><span class="hll">[ Surface ]
</span><span class="hll">    1   SPH  -1.3673469387755102 0 -0.7672719285390251  0.027723013645953594 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    2   SPH  -1.2653061224489797 0 -0.6606685327429188  0.02829460213179771 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    3   SPH  -1.163265306122449 0 -0.502391908191501  0.02887797553400489 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    4   SPH  -1.0612244897959182 0 -0.31087406445720084  0.029473376832021225 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    5   SPH  -0.9591836734693877 0 -0.10612250568576122  0.03008105401500263 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    6   SPH  -0.8571428571428572 0 0.09222119831628449  0.0307012601851042 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    7   SPH  -0.7551020408163263 0 0.26663740363716293  0.031334253662899186 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    8   SPH  -0.6530612244897958 0 0.4031539294877735  0.031980298094971465 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    9   SPH  -0.5510204081632653 0 0.49233751776643636  0.032639662563726336 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    10   SPH  -0.44897959183673475 0 0.5297951558796689  0.033312621699465396 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    11   SPH  -0.34693877551020424 0 0.516178133105813  0.03399945579477215 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    12   SPH  -0.2448979591836733 0 0.4567274424263816  0.03470045092125597 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    13   SPH  -0.1428571428571428 0 0.36043778735561943  0.035415899048703105 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    14   SPH  -0.04081632653061229 0 0.23894605136204328  0.03614609816668431 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    15   SPH  0.06122448979591866 0 0.10526682529176924  0.03689135240866978 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    16   SPH  0.16326530612244916 0 -0.027498125343700826  0.03765197217870301 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    17   SPH  0.26530612244897966 0 -0.1473571496828118  0.03842827428068646 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    18   SPH  0.36734693877551017 0 -0.2444312783541894  0.03922058205033278 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    19   SPH  0.46938775510204067 0 -0.3116862365829553  0.040029225489836576 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    20   SPH  0.5714285714285716 0 -0.34534859980043214  0.040854541405322846 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    21   SPH  0.6734693877551021 0 -0.34499303885518234  0.04169687354712925 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    22   SPH  0.7755102040816326 0 -0.31331851066930916  0.04255657275298077 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    23   SPH  0.8775510204081636 0 -0.2556581135852169  0.04343399709411627 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    24   SPH  0.9795918367346941 0 -0.1792880209486128  0.04432951202442788 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    25   SPH  1.0816326530612246 0 -0.09261403493598512  0.04524349053267528 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    26   SPH  1.183673469387755 0 -0.004319265460356921  0.04617631329783845 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    27   SPH  1.2857142857142856 0 0.07744657465511029  0.04712836884767322 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    28   SPH  1.387755102040816 0 0.1457658580616131  0.04810005372053611 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    29   SPH  1.4897959183673475 0 0.1954850113560298  0.049091772630545545 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    30   SPH  1.591836734693878 0 0.22354449689276956  0.05010393863614837 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    31   SPH  1.6938775510204085 0 0.22909265869423243  0.051136973312161764 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    32   SPH  1.795918367346939 0 0.21339003096231585  0.052191306925362425 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    33   SPH  1.8979591836734695 0 0.17952922947672972  0.05326737861369591 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    34   SPH  2.0 0 0.1320103335494828  0.054365636569180906 $ name: &#39;SPH&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    35   TRC  2.0 0.054365636569180906 0.1320103335494828  0 0.07248751542557454 0  0.03624375771278727  1e-09 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    36   RCC  -1.4673469387755103 0 -0.7672719285390251  4 0 0  3 $ name: &#39;RCC&#39; (cylinder) [x0 y0 z0] [Hx Hy Hz] R
</span><span class="hll">
</span><span class="hll">[ Cell ]
</span><span class="hll">    100 -1  (36) $ name: &#39;Cell&#39; 
</span><span class="hll">
</span><span class="hll">    101 2  1.09  (-1)   $ name: &#39;Snake Part 0&#39; 
</span><span class="hll">    102 2  1.09  (-2)   $ name: &#39;Snake Part 1&#39; 
</span><span class="hll">    103 2  1.09  (-3)   $ name: &#39;Snake Part 2&#39; 
</span><span class="hll">    104 2  1.09  (-4)   $ name: &#39;Snake Part 3&#39; 
</span><span class="hll">    105 2  1.09  (-5)   $ name: &#39;Snake Part 4&#39; 
</span><span class="hll">    106 2  1.09  (-6)   $ name: &#39;Snake Part 5&#39; 
</span><span class="hll">    107 2  1.09  (-7)   $ name: &#39;Snake Part 6&#39; 
</span><span class="hll">    108 2  1.09  (-8)   $ name: &#39;Snake Part 7&#39; 
</span><span class="hll">    109 2  1.09  (-9)   $ name: &#39;Snake Part 8&#39; 
</span><span class="hll">    110 2  1.09  (-10)   $ name: &#39;Snake Part 9&#39; 
</span><span class="hll">    111 2  1.09  (-11)   $ name: &#39;Snake Part 10&#39; 
</span><span class="hll">    112 2  1.09  (-12)   $ name: &#39;Snake Part 11&#39; 
</span><span class="hll">    113 2  1.09  (-13)   $ name: &#39;Snake Part 12&#39; 
</span><span class="hll">    114 2  1.09  (-14)   $ name: &#39;Snake Part 13&#39; 
</span><span class="hll">    115 2  1.09  (-15)   $ name: &#39;Snake Part 14&#39; 
</span><span class="hll">    116 2  1.09  (-16)   $ name: &#39;Snake Part 15&#39; 
</span><span class="hll">    117 2  1.09  (-17)   $ name: &#39;Snake Part 16&#39; 
</span><span class="hll">    118 2  1.09  (-18)   $ name: &#39;Snake Part 17&#39; 
</span><span class="hll">    119 2  1.09  (-19)   $ name: &#39;Snake Part 18&#39; 
</span><span class="hll">    120 2  1.09  (-20)   $ name: &#39;Snake Part 19&#39; 
</span><span class="hll">    121 2  1.09  (-21)   $ name: &#39;Snake Part 20&#39; 
</span><span class="hll">    122 2  1.09  (-22)   $ name: &#39;Snake Part 21&#39; 
</span><span class="hll">    123 2  1.09  (-23)   $ name: &#39;Snake Part 22&#39; 
</span><span class="hll">    124 2  1.09  (-24)   $ name: &#39;Snake Part 23&#39; 
</span><span class="hll">    125 2  1.09  (-25)   $ name: &#39;Snake Part 24&#39; 
</span><span class="hll">    126 2  1.09  (-26)   $ name: &#39;Snake Part 25&#39; 
</span><span class="hll">    127 2  1.09  (-27)   $ name: &#39;Snake Part 26&#39; 
</span><span class="hll">    128 2  1.09  (-28)   $ name: &#39;Snake Part 27&#39; 
</span><span class="hll">    129 2  1.09  (-29)   $ name: &#39;Snake Part 28&#39; 
</span><span class="hll">    130 2  1.09  (-30)   $ name: &#39;Snake Part 29&#39; 
</span><span class="hll">    131 2  1.09  (-31)   $ name: &#39;Snake Part 30&#39; 
</span><span class="hll">    132 2  1.09  (-32)   $ name: &#39;Snake Part 31&#39; 
</span><span class="hll">    133 2  1.09  (-33)   $ name: &#39;Snake Part 32&#39; 
</span><span class="hll">    134 2  1.09  (-34)   $ name: &#39;Snake Part 33&#39; 
</span><span class="hll">    135 3  0.93  (-35)   $ name: &#39;Hat!&#39; 
</span><span class="hll">    136 0  (-36) (1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35) $ name: &#39;Vacuum&#39; 
</span>
[ T-Track ]
    title = Track Detection in xyz mesh
    
    mesh =  xyz             # mesh type is xyz scoring mesh
        x-type = 2          # x-mesh is linear given by xmin, xmax and nx
        nx = 240            # number of x-mesh points
        xmin = -3.0         # minimum value of x-mesh points
        xmax = 3.0          # maximum value of x-mesh points

        y-type = 1          # y-mesh is given by the below data
        ny = 1              # number of y-mesh points
        -0.7 0.7            # 

        z-type = 2          # z-mesh is linear given by zmin, zmax and nz
        nz = 240            # number of z-mesh points
        zmin = -2.0         # minimum value of z-mesh points
        zmax = 2.0          # maximum value of z-mesh points

        axis = xz           # axis of output

        e-type = 1          # e-mesh is given by the below data
        ne = 1              # number of e-mesh points
        0.0 50.0            # number of l-mesh points

    unit = 1                # unit is [1/cm^2/source] fluence
    file = track_xyz-xz.out # file name of output for the above axis
    
    part = all         
    part = electron    
    part = proton      
    part = neutron     
    part = photon          
    
    gshow = 1               # 0: no 1:bnd, 2:bnd+mat, 3:bnd+reg 4:bnd+lat
    epsout = 1              # (D=0) generate eps file by ANGEL


[ T-3Dshow ]
	title = Geometry 3D
	x0 = 0
	y0 = 0
	z0 = 0

	w-wdt = 1
	w-hgt = 1
	w-dst = 20

	w-mnw = 400			# Number of meshes in horizontal direction.
	w-mnh = 400			# Number of meshes in vertical direction.
	w-ang = 0

	e-the = 90
	e-phi = 20
	e-dst = 50

	l-the = 80
	l-phi = 140
	l-dst = 200*100

	file = snake_3D
	output = 3			# (D=3) Region boundary + color
	width = 0.5			# (D=0.5) The option defines the line thickness.
	epsout = 1

[ E n d ]
</pre></div>
</td></tr></table></div>
</div>
<div class="align-center figure" id="id27">
<img alt="{{ base_path }}/fitsgeo/_images/snake_3D.png" src="{{ base_path }}/fitsgeo/_images/snake_3D.png" />
<p class="caption"><span class="caption-text"><strong>Example 2(b): Snake! PHITS visualization</strong></span><a class="headerlink" href="#id27" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="example-3-snowman">
<h2>Example 3: Snowman<a class="headerlink" href="#example-3-snowman" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Illustrative example of FitsGeo usage. Shows general workflow of creating complex geometry</p>
<div class="align-center figure" id="id28">
<img alt="{{ base_path }}/fitsgeo/_images/snowman_fitsgeo.png" src="{{ base_path }}/fitsgeo/_images/snowman_fitsgeo.png" />
<p class="caption"><span class="caption-text"><strong>Example 3: Snowman. FitsGeo visualization</strong></span><a class="headerlink" href="#id28" title="Permalink to this image">¶</a></p>
</div>
<p>This example shows general workflow of work with FitsGeo, example contains all discussed features to build complex geometry — pretty snowman. The final result of visualization via FitsGeo is in the picture above and the full code of the example is shown below.</p>
<div class="toggle-header docutils container">
<p><strong>Example 3: Snowman</strong></p>
</div>
<div class="toggle-content docutils container">
<div class="highlight-python notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Example 3: Snowman.</span>
<span class="c1"># Illustrative example of FitsGeo usage</span>
<span class="c1"># Shows general workflow of creating complex geometry</span>
<span class="kn">import</span> <span class="nn">fitsgeo</span> <span class="k">as</span> <span class="nn">fg</span>

<span class="c1"># Create main scene, with axis</span>
<span class="n">fg</span><span class="o">.</span><span class="n">create_scene</span><span class="p">(</span><span class="n">ax_length</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">fg</span><span class="o">.</span><span class="n">WHITE</span><span class="p">)</span>

<span class="c1"># Define materials</span>
<span class="n">fg</span><span class="o">.</span><span class="n">MAT_WATER</span><span class="o">.</span><span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;lightgray&quot;</span>
<span class="n">ice</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">MAT_WATER</span>
<span class="n">carbon</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_CARBON&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">)</span>
<span class="n">poly</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Material</span><span class="o">.</span><span class="n">database</span><span class="p">(</span><span class="s2">&quot;MAT_PARAFFIN&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;orange&quot;</span><span class="p">)</span>

<span class="c1"># Create all objects for snowman</span>
<span class="n">bottom</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">SPH</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">ice</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;bottom&quot;</span><span class="p">)</span>

<span class="n">middle</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">SPH</span><span class="p">(</span>
	<span class="p">[</span><span class="n">bottom</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">bottom</span><span class="o">.</span><span class="n">y0</span><span class="o">+</span><span class="n">bottom</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">bottom</span><span class="o">.</span><span class="n">z0</span><span class="p">],</span>
	<span class="n">bottom</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">ice</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;middle&quot;</span><span class="p">)</span>

<span class="n">top</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">SPH</span><span class="p">(</span>
	<span class="p">[</span>
		<span class="n">middle</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span>
		<span class="n">middle</span><span class="o">.</span><span class="n">y0</span><span class="o">+</span><span class="n">middle</span><span class="o">.</span><span class="n">r</span><span class="o">*</span><span class="mf">1.2</span><span class="p">,</span>
		<span class="n">middle</span><span class="o">.</span><span class="n">z0</span><span class="p">],</span>
	<span class="n">middle</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">ice</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;top&quot;</span><span class="p">)</span>

<span class="n">carrot</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">TRC</span><span class="p">(</span>
	<span class="p">[</span>
		<span class="n">top</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span>
		<span class="n">top</span><span class="o">.</span><span class="n">y0</span><span class="o">+</span><span class="n">top</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span>
		<span class="n">top</span><span class="o">.</span><span class="n">z0</span><span class="o">+</span><span class="n">top</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span>
	<span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">diameter</span><span class="o">*</span><span class="mf">0.8</span><span class="p">],</span> <span class="n">top</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span> <span class="mf">1e-3</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">poly</span><span class="p">)</span>

<span class="n">hat_bottom</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">RCC</span><span class="p">(</span>
	<span class="p">[</span><span class="n">top</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">y0</span><span class="o">+</span><span class="n">top</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">z0</span><span class="p">],</span>
	<span class="p">[</span><span class="n">top</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">middle</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span> <span class="n">top</span><span class="o">.</span><span class="n">z0</span><span class="p">],</span>
	<span class="n">top</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">carbon</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Hat bottom&quot;</span><span class="p">)</span>

<span class="n">hat_top</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">RCC</span><span class="p">(</span>
	<span class="p">[</span>
		<span class="n">hat_bottom</span><span class="o">.</span><span class="n">get_center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
		<span class="n">hat_bottom</span><span class="o">.</span><span class="n">get_center</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">hat_bottom</span><span class="o">.</span><span class="n">get_len_h</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
		<span class="n">hat_bottom</span><span class="o">.</span><span class="n">get_center</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
	<span class="p">[</span><span class="n">hat_bottom</span><span class="o">.</span><span class="n">get_center</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">hat_bottom</span><span class="o">.</span><span class="n">get_len_h</span><span class="o">*</span><span class="mi">4</span><span class="p">,</span> <span class="n">hat_bottom</span><span class="o">.</span><span class="n">get_center</span><span class="p">[</span><span class="mi">2</span><span class="p">]],</span>
	<span class="n">hat_bottom</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">carbon</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Hat top&quot;</span><span class="p">)</span>

<span class="n">eye_l</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">SPH</span><span class="p">(</span>
	<span class="p">[</span>
		<span class="n">top</span><span class="o">.</span><span class="n">x0</span> <span class="o">-</span> <span class="n">top</span><span class="o">.</span><span class="n">r</span><span class="o">*</span><span class="mf">0.3</span><span class="p">,</span>
		<span class="n">top</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">top</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
		<span class="n">top</span><span class="o">.</span><span class="n">z0</span> <span class="o">+</span> <span class="n">top</span><span class="o">.</span><span class="n">r</span><span class="o">*</span><span class="mf">0.8</span><span class="p">],</span>
	<span class="n">top</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">carbon</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Left Eye&quot;</span><span class="p">)</span>

<span class="n">eye_r</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">SPH</span><span class="p">(</span>
	<span class="p">[</span>
		<span class="n">top</span><span class="o">.</span><span class="n">x0</span> <span class="o">+</span> <span class="n">top</span><span class="o">.</span><span class="n">r</span><span class="o">*</span><span class="mf">0.3</span><span class="p">,</span>
		<span class="n">top</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">top</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span>
		<span class="n">top</span><span class="o">.</span><span class="n">z0</span> <span class="o">+</span> <span class="n">top</span><span class="o">.</span><span class="n">r</span><span class="o">*</span><span class="mf">0.8</span><span class="p">],</span>
	<span class="n">eye_l</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">carbon</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Right Eye&quot;</span><span class="p">)</span>

<span class="n">button1</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">SPH</span><span class="p">(</span>
	<span class="p">[</span>
		<span class="n">middle</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span>
		<span class="n">middle</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="n">middle</span><span class="o">.</span><span class="n">r</span><span class="o">*</span><span class="mf">0.4</span><span class="p">,</span>
		<span class="n">middle</span><span class="o">.</span><span class="n">z0</span> <span class="o">+</span> <span class="n">middle</span><span class="o">.</span><span class="n">r</span><span class="o">*</span><span class="mf">0.9</span><span class="p">],</span>
	<span class="n">eye_r</span><span class="o">.</span><span class="n">r</span><span class="o">*</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">carbon</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Button1&quot;</span><span class="p">)</span>

<span class="n">button2</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">SPH</span><span class="p">(</span>
	<span class="p">[</span>
		<span class="n">middle</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span>
		<span class="n">middle</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span>
		<span class="n">middle</span><span class="o">.</span><span class="n">z0</span> <span class="o">+</span> <span class="n">middle</span><span class="o">.</span><span class="n">r</span><span class="p">],</span>
	<span class="n">button1</span><span class="o">.</span><span class="n">r</span><span class="o">*</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">carbon</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Button2&quot;</span><span class="p">)</span>

<span class="n">mouth1</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">T</span><span class="p">(</span>
	<span class="p">[</span>
		<span class="n">top</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span>
		<span class="n">top</span><span class="o">.</span><span class="n">y0</span><span class="o">*</span><span class="mf">0.95</span><span class="p">,</span>
		<span class="n">top</span><span class="o">.</span><span class="n">z0</span> <span class="o">+</span> <span class="n">top</span><span class="o">.</span><span class="n">r</span><span class="p">],</span>
	<span class="n">top</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="mi">30</span><span class="p">,</span> <span class="n">eye_l</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span> <span class="n">eye_l</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span>
	<span class="n">name</span><span class="o">=</span><span class="s2">&quot;Mouth 1&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">carbon</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="s2">&quot;z&quot;</span><span class="p">)</span>

<span class="n">mouth2</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">T</span><span class="p">(</span>
	<span class="p">[</span>
		<span class="n">top</span><span class="o">.</span><span class="n">x0</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mouth1</span><span class="o">.</span><span class="n">r</span><span class="p">,</span>
		<span class="n">top</span><span class="o">.</span><span class="n">y0</span><span class="o">*</span><span class="mf">0.95</span> <span class="o">+</span> <span class="mf">1.1</span><span class="o">*</span><span class="n">mouth1</span><span class="o">.</span><span class="n">r</span><span class="p">,</span>
		<span class="n">top</span><span class="o">.</span><span class="n">z0</span> <span class="o">+</span> <span class="n">top</span><span class="o">.</span><span class="n">r</span><span class="p">],</span>
	<span class="n">mouth1</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">eye_l</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span> <span class="n">eye_l</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span>
	<span class="n">name</span><span class="o">=</span><span class="s2">&quot;Mouth 2&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">carbon</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="s2">&quot;z&quot;</span><span class="p">)</span>

<span class="n">mouth3</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">T</span><span class="p">(</span>
	<span class="p">[</span>
		<span class="n">top</span><span class="o">.</span><span class="n">x0</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mouth1</span><span class="o">.</span><span class="n">r</span><span class="p">,</span>
		<span class="n">top</span><span class="o">.</span><span class="n">y0</span><span class="o">*</span><span class="mf">0.95</span> <span class="o">+</span> <span class="mf">1.1</span><span class="o">*</span><span class="n">mouth1</span><span class="o">.</span><span class="n">r</span><span class="p">,</span>
		<span class="n">top</span><span class="o">.</span><span class="n">z0</span> <span class="o">+</span> <span class="n">top</span><span class="o">.</span><span class="n">r</span><span class="p">],</span>
	<span class="n">mouth1</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">eye_l</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span> <span class="n">eye_l</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span>
	<span class="n">name</span><span class="o">=</span><span class="s2">&quot;Mouth 3&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">carbon</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="s2">&quot;z&quot;</span><span class="p">)</span>

<span class="n">mouth4</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">T</span><span class="p">(</span>
	<span class="p">[</span>
		<span class="n">mouth3</span><span class="o">.</span><span class="n">x0</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">mouth1</span><span class="o">.</span><span class="n">r</span><span class="p">,</span>
		<span class="n">mouth3</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">mouth1</span><span class="o">.</span><span class="n">r</span><span class="p">,</span>
		<span class="n">mouth3</span><span class="o">.</span><span class="n">z0</span><span class="p">],</span>
	<span class="n">mouth1</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">eye_l</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span> <span class="n">eye_l</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span>
	<span class="n">name</span><span class="o">=</span><span class="s2">&quot;Mouth 4&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">carbon</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="s2">&quot;z&quot;</span><span class="p">)</span>

<span class="n">mouth5</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">T</span><span class="p">(</span>
	<span class="p">[</span>
		<span class="n">mouth2</span><span class="o">.</span><span class="n">x0</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">mouth1</span><span class="o">.</span><span class="n">r</span><span class="p">,</span>
		<span class="n">mouth2</span><span class="o">.</span><span class="n">y0</span> <span class="o">+</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">mouth1</span><span class="o">.</span><span class="n">r</span><span class="p">,</span>
		<span class="n">mouth2</span><span class="o">.</span><span class="n">z0</span><span class="p">],</span>
	<span class="n">mouth1</span><span class="o">.</span><span class="n">r</span><span class="p">,</span> <span class="n">eye_l</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="mi">7</span><span class="p">,</span> <span class="n">eye_l</span><span class="o">.</span><span class="n">r</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span>
	<span class="n">name</span><span class="o">=</span><span class="s2">&quot;Mouth 5&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">carbon</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="s2">&quot;z&quot;</span><span class="p">)</span>

<span class="n">outer</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">SPH</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;Outer edge&quot;</span><span class="p">,</span> <span class="n">material</span><span class="o">=</span><span class="n">fg</span><span class="o">.</span><span class="n">MAT_VOID</span><span class="p">)</span>

<span class="c1"># Create cells</span>
<span class="n">outer_c</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">+</span><span class="n">outer</span><span class="p">],</span> <span class="s2">&quot;Outer Void&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">.</span><span class="n">MAT_OUTER</span><span class="p">)</span>
<span class="n">inner_c</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span>
	<span class="p">[</span><span class="o">-</span><span class="n">outer</span> <span class="o">+</span> <span class="o">+</span><span class="n">bottom</span> <span class="o">+</span> <span class="o">+</span><span class="n">middle</span> <span class="o">+</span> <span class="o">+</span><span class="n">top</span> <span class="o">+</span> <span class="o">+</span><span class="n">hat_bottom</span> <span class="o">+</span> <span class="o">+</span><span class="n">hat_top</span> <span class="o">+</span> <span class="o">+</span><span class="n">carrot</span> <span class="o">+</span>
	 	<span class="o">+</span><span class="n">eye_l</span> <span class="o">+</span> <span class="o">+</span><span class="n">eye_r</span> <span class="o">+</span> <span class="o">+</span><span class="n">button1</span> <span class="o">+</span> <span class="o">+</span><span class="n">button2</span> <span class="o">+</span>
	 	<span class="o">+</span><span class="n">mouth1</span> <span class="o">+</span> <span class="o">+</span><span class="n">mouth2</span> <span class="o">+</span> <span class="o">+</span><span class="n">mouth3</span> <span class="o">+</span> <span class="o">+</span><span class="n">mouth4</span> <span class="o">+</span> <span class="o">+</span><span class="n">mouth5</span><span class="p">],</span>
	<span class="s2">&quot;Inner Cell&quot;</span><span class="p">,</span> <span class="n">fg</span><span class="o">.</span><span class="n">MAT_VOID</span><span class="p">)</span>
<span class="n">bottom_c</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">-</span><span class="n">bottom</span> <span class="o">+</span> <span class="o">+</span><span class="n">middle</span><span class="p">],</span> <span class="s2">&quot;Bottom Cell&quot;</span><span class="p">,</span> <span class="n">ice</span><span class="p">)</span>
<span class="n">middle_c</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span>
	<span class="p">[</span><span class="o">-</span><span class="n">middle</span> <span class="o">+</span> <span class="o">+</span><span class="n">button1</span> <span class="o">+</span> <span class="o">+</span><span class="n">button2</span> <span class="o">+</span> <span class="o">+</span><span class="n">top</span><span class="p">],</span> <span class="s2">&quot;Middle Cell&quot;</span><span class="p">,</span> <span class="n">ice</span><span class="p">)</span>
<span class="n">top_c</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">(</span>
	<span class="p">[</span><span class="o">-</span><span class="n">top</span> <span class="o">+</span> <span class="o">+</span><span class="n">carrot</span> <span class="o">+</span> <span class="o">+</span><span class="n">eye_l</span> <span class="o">+</span> <span class="o">+</span><span class="n">eye_r</span><span class="p">],</span>
	<span class="s2">&quot;Top Cell&quot;</span><span class="p">,</span> <span class="n">ice</span><span class="p">)</span>

<span class="n">buttons</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">btn</span> <span class="ow">in</span> <span class="p">[</span><span class="n">button1</span><span class="p">,</span> <span class="n">button2</span><span class="p">]:</span>
	<span class="n">buttons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">-</span><span class="n">btn</span><span class="p">],</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">btn</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> Cell&quot;</span><span class="p">,</span> <span class="n">carbon</span><span class="p">,</span> <span class="n">btn</span><span class="o">.</span><span class="n">volume</span><span class="p">))</span>

<span class="n">mouth</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="n">mouth1</span><span class="p">,</span> <span class="n">mouth2</span><span class="p">,</span> <span class="n">mouth3</span><span class="p">,</span> <span class="n">mouth4</span><span class="p">,</span> <span class="n">mouth5</span><span class="p">]:</span>
	<span class="n">mouth</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">-</span><span class="n">m</span><span class="p">],</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">m</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> Cell&quot;</span><span class="p">,</span> <span class="n">carbon</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">get_volume</span><span class="p">))</span>

<span class="n">eyes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">eye</span> <span class="ow">in</span> <span class="p">[</span><span class="n">eye_l</span><span class="p">,</span> <span class="n">eye_r</span><span class="p">]:</span>
	<span class="n">eyes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">-</span><span class="n">eye</span><span class="p">],</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">eye</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> Cell&quot;</span><span class="p">,</span> <span class="n">carbon</span><span class="p">,</span> <span class="n">eye</span><span class="o">.</span><span class="n">volume</span><span class="p">))</span>

<span class="n">carrot_c</span> <span class="o">=</span> <span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">-</span><span class="n">carrot</span><span class="p">],</span> <span class="s2">&quot;Carrot Cell&quot;</span><span class="p">,</span> <span class="n">poly</span><span class="p">,</span> <span class="n">carrot</span><span class="o">.</span><span class="n">get_volume</span><span class="p">)</span>

<span class="n">hat</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">h</span> <span class="ow">in</span> <span class="p">[</span><span class="n">hat_bottom</span><span class="p">,</span> <span class="n">hat_top</span><span class="p">]:</span>
	<span class="n">hat</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fg</span><span class="o">.</span><span class="n">Cell</span><span class="p">([</span><span class="o">-</span><span class="n">h</span><span class="p">],</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">h</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2"> Cell&quot;</span><span class="p">,</span> <span class="n">carbon</span><span class="p">,</span> <span class="n">h</span><span class="o">.</span><span class="n">get_volume</span><span class="p">))</span>

<span class="c1"># Draw all defined objects</span>
<span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">[</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">fg</span><span class="o">.</span><span class="n">created_surfaces</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">carrot</span><span class="p">]:</span>
	<span class="n">s</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="n">carrot</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">truncated</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Export all drawn surfaces to PHITS input sections</span>
<span class="n">fg</span><span class="o">.</span><span class="n">phits_export</span><span class="p">(</span><span class="n">to_file</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inp_name</span><span class="o">=</span><span class="s2">&quot;snowman&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<p>The main idea in this example was to make the bottom snowball of snowman and to set every other part of snowman relative to this object. This example doesn’t need any additional commentaries, every feature was discussed in the previous examples. Just try to run the example and look carefully how the geometry was set in the code.</p>
<p>Full PHITS input file and visualization of geometry via ANGEL are shown below. The highlighted part of the code — exported sections from FitsGeo.</p>
<div class="toggle-header docutils container">
<p><strong>Example 3: Snowman. PHITS input</strong></p>
</div>
<div class="toggle-content docutils container">
<div class="highlight-none notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92</pre></div></td><td class="code"><div class="highlight"><pre><span></span>[ Title ]
	Snowman (Example3): one more example of how to use FitsGeo module
	Illustrative example of FitsGeo usage
	Shows general workflow

[ Parameters ]
	icntl = 11			# (D=0) 3:ECH 5:ALL VOID 6:SRC 7,8:GSH 11:DSH 12:DUMP

[ Source ]
	s-type = 2			# mono-energetic rectangular source 
	e0 = 1				# energy of beam [MeV]
	proj = proton		# kind of incident particle

<span class="hll">[ Material ]
</span><span class="hll">    mat[1] H 2.0 O 1.0  GAS=0 $ name: &#39;MAT_WATER&#39;
</span><span class="hll">    mat[2] C 6.0  GAS=0 $ name: &#39;MAT_CARBON&#39;
</span><span class="hll">    mat[3] H 2.0 C 1.0  GAS=0 $ name: &#39;MAT_PARAFFIN&#39;
</span><span class="hll">
</span><span class="hll">[ Mat Name Color ]
</span><span class="hll">    mat name    size    color
</span><span class="hll">    1   {MAT\_WATER}    1.00    lightgray
</span><span class="hll">    2   {MAT\_CARBON}   1.00    black
</span><span class="hll">    3   {MAT\_PARAFFIN} 1.00    orange
</span><span class="hll">
</span><span class="hll">[ Surface ]
</span><span class="hll">    1   SPH  0 0 0  1 $ name: &#39;bottom&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    2   SPH  0 1 0  0.6666666666666666 $ name: &#39;middle&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    3   SPH  0 1.7999999999999998 0  0.4444444444444444 $ name: &#39;top&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    4   TRC  0 1.911111111111111 0.2222222222222222  0 0 0.7111111111111111  0.07407407407407407  0.001 $ name: &#39;RCC&#39; (truncated right-angle cone) [x0 y0 z0] [Hx Hy Hz] R_b R_t
</span><span class="hll">    5   RCC  0 2.2444444444444445 0  0 0.09523809523809523 0  0.2962962962962963 $ name: &#39;Hat bottom&#39; (cylinder) [x0 y0 z0] [Hx Hy Hz] R
</span><span class="hll">    6   RCC  0.0 2.3396825396825394 0.0  0.0 0.38095238095238093 0.0  0.19753086419753085 $ name: &#39;Hat top&#39; (cylinder) [x0 y0 z0] [Hx Hy Hz] R
</span><span class="hll">    7   SPH  -0.13333333333333333 2.022222222222222 0.35555555555555557  0.04444444444444444 $ name: &#39;Left Eye&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    8   SPH  0.13333333333333333 2.022222222222222 0.35555555555555557  0.04444444444444444 $ name: &#39;Right Eye&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    9   SPH  0 1.2666666666666666 0.6  0.05333333333333332 $ name: &#39;Button1&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    10   SPH  0 1 0.6666666666666666  0.05866666666666666 $ name: &#39;Button2&#39; (sphere) x0 y0 z0 R
</span><span class="hll">    11   TZ  0 1.7099999999999997 0.4444444444444444  0.014814814814814814  0.006349206349206348  0.008888888888888887 $ name: &#39;Mouth 1&#39; (torus, with z rotational axis) [x0 y0 z0] A(R) B C
</span><span class="hll">    12   TZ  0.04444444444444444 1.726296296296296 0.4444444444444444  0.014814814814814814  0.006349206349206348  0.008888888888888887 $ name: &#39;Mouth 2&#39; (torus, with z rotational axis) [x0 y0 z0] A(R) B C
</span><span class="hll">    13   TZ  -0.04444444444444444 1.726296296296296 0.4444444444444444  0.014814814814814814  0.006349206349206348  0.008888888888888887 $ name: &#39;Mouth 3&#39; (torus, with z rotational axis) [x0 y0 z0] A(R) B C
</span><span class="hll">    14   TZ  -0.08888888888888888 1.7485185185185181 0.4444444444444444  0.014814814814814814  0.006349206349206348  0.008888888888888887 $ name: &#39;Mouth 4&#39; (torus, with z rotational axis) [x0 y0 z0] A(R) B C
</span><span class="hll">    15   TZ  0.08888888888888888 1.7485185185185181 0.4444444444444444  0.014814814814814814  0.006349206349206348  0.008888888888888887 $ name: &#39;Mouth 5&#39; (torus, with z rotational axis) [x0 y0 z0] A(R) B C
</span><span class="hll">    16   SPH  0.0 0.0 0.0  3 $ name: &#39;Outer edge&#39; (sphere) x0 y0 z0 R
</span><span class="hll">
</span><span class="hll">[ Cell ]
</span><span class="hll">    100 -1  (16) $ name: &#39;Outer Void&#39; 
</span><span class="hll">
</span><span class="hll">    101 0  (-16 1 2 3 5 6 4 7 8 9 10 11 12 13 14 15) $ name: &#39;Inner Cell&#39; 
</span><span class="hll">
</span><span class="hll">    102 1  1.0  (-1 2)   $ name: &#39;Bottom Cell&#39; 
</span><span class="hll">    103 1  1.0  (-2 9 10 3)   $ name: &#39;Middle Cell&#39; 
</span><span class="hll">    104 1  1.0  (-3 4 7 8)   $ name: &#39;Top Cell&#39; 
</span><span class="hll">    105 2  2.0  (-9)  VOL=0.0006354549881038906 $ name: &#39;Button1 Cell&#39; 
</span><span class="hll">    106 2  2.0  (-10)  VOL=0.0008457905891662785 $ name: &#39;Button2 Cell&#39; 
</span><span class="hll">    107 2  2.0  (-11)  VOL=1.6504139569396266e-05 $ name: &#39;Mouth 1 Cell&#39; 
</span><span class="hll">    108 2  2.0  (-12)  VOL=1.6504139569396266e-05 $ name: &#39;Mouth 2 Cell&#39; 
</span><span class="hll">    109 2  2.0  (-13)  VOL=1.6504139569396266e-05 $ name: &#39;Mouth 3 Cell&#39; 
</span><span class="hll">    110 2  2.0  (-14)  VOL=1.6504139569396266e-05 $ name: &#39;Mouth 4 Cell&#39; 
</span><span class="hll">    111 2  2.0  (-15)  VOL=1.6504139569396266e-05 $ name: &#39;Mouth 5 Cell&#39; 
</span><span class="hll">    112 2  2.0  (-7)  VOL=0.00036774015515271454 $ name: &#39;Left Eye Cell&#39; 
</span><span class="hll">    113 2  2.0  (-8)  VOL=0.00036774015515271454 $ name: &#39;Right Eye Cell&#39; 
</span><span class="hll">    114 3  0.89  (-4)  VOL=0.004141907421006144 $ name: &#39;Carrot Cell&#39; 
</span><span class="hll">    115 2  2.0  (-5)  VOL=0.026267153939479614 $ name: &#39;Hat bottom Cell&#39; 
</span><span class="hll">    116 2  2.0  (-6)  VOL=0.04669716255907488 $ name: &#39;Hat top Cell&#39; 
</span>
[ T-3Dshow ]
	title = Geometry 3D
	x0 = 0
	y0 = 1
	z0 = 0

	w-wdt = 4
	w-hgt = 4
	w-dst = 10

	w-mnw = 400		# Number of meshes in horizontal direction.
	w-mnh = 400		# Number of meshes in vertical direction.
	w-ang = 0

	e-the = 40
	e-phi = 120
	e-dst = 100

	l-the = 80
	l-phi = 140
	l-dst = 200*100

	file = snowman_3D
	output = 3		# (D=3) Region boundary + color
	width = 0.5		# (D=0.5) The option defines the line thickness.

	epsout = 1

[ E n d ]
</pre></div>
</td></tr></table></div>
</div>
<div class="align-center figure" id="id29">
<img alt="{{ base_path }}/fitsgeo/_images/snowman_3D.png" src="{{ base_path }}/fitsgeo/_images/snowman_3D.png" />
<p class="caption"><span class="caption-text"><strong>Example 3: Snowman. PHITS visualization</strong></span><a class="headerlink" href="#id29" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2020, Ivan Gordeev.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.1.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="{{ base_path }}/fitsgeo/_sources/user_guide.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>